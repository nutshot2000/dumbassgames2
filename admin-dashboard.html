<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëë DUMBASSGAMES Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P:wght@400&display=swap" rel="stylesheet">
    <style>
        /* Retro Admin Dashboard Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #0a0a0a, #1a1a2e, #16213e);
            color: #00ff00;
            min-height: 100vh;
            overflow-x: auto;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, transparent 98%, rgba(0, 255, 0, 0.03) 100%),
                linear-gradient(180deg, transparent 98%, rgba(0, 255, 255, 0.03) 100%);
            background-size: 25px 25px;
            animation: grid 20s linear infinite;
            z-index: -1;
        }

        @keyframes grid {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 25px 25px, 25px 25px; }
        }

        .admin-header {
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #00ff00;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .admin-title {
            font-family: 'Press Start 2P', monospace;
            font-size: 24px;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff;
            margin-bottom: 10px;
        }

        .admin-subtitle {
            color: #888;
            font-size: 14px;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .stats-panel {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }

        .panel-title {
            font-family: 'Press Start 2P', monospace;
            font-size: 16px;
            color: #00ffff;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 10px #00ffff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 20, 0, 0.8);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            background: rgba(0, 30, 0, 0.9);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
            transform: translateY(-2px);
        }

        .stat-label {
            font-size: 12px;
            color: #888;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00;
        }

        .commands-panel {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .commands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .admin-btn {
            background: linear-gradient(45deg, #001100, #003300);
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 12px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .admin-btn:hover {
            background: linear-gradient(45deg, #002200, #004400);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
            transform: translateY(-1px);
        }

        .admin-btn:active {
            transform: translateY(1px);
        }

        .console-output {
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        .console-output::-webkit-scrollbar {
            width: 8px;
        }

        .console-output::-webkit-scrollbar-track {
            background: #111;
        }

        .console-output::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }

        .loading-indicator {
            display: inline-block;
            color: #ffff00;
        }

        .loading-indicator::after {
            content: '...';
            animation: dots 1s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            
            .admin-title {
                font-size: 18px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .commands-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .error-text { color: #ff4444; }
        .success-text { color: #00ff00; }
        .warning-text { color: #ffff00; }
        .info-text { color: #00ffff; }
    </style>

</head>
<body>
    <div class="admin-header">
        <div class="admin-title">üëë ADMIN CONSOLE</div>
        <div class="admin-subtitle">DUMBASSGAMES Site Management Dashboard</div>
    </div>

    <div class="dashboard-container">
        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="panel-title">üìä SITE STATISTICS</div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Site Status</div>
                    <div class="stat-value" id="siteStatus">‚è≥ LOADING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Games</div>
                    <div class="stat-value" id="totalGames">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Users Online</div>
                    <div class="stat-value" id="usersOnline">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Top Search</div>
                    <div class="stat-value" id="topSearch">-</div>
                </div>
            </div>
        </div>

        <!-- Commands Panel -->
        <div class="commands-panel">
            <div class="panel-title">‚ö° ADMIN COMMANDS</div>
            <div class="commands-grid">
                <button class="admin-btn" onclick="runCommand('dailyReport')">üìä Daily Report</button>
                <button class="admin-btn" onclick="runCommand('siteHealth')">üè• Site Health</button>
                <button class="admin-btn" onclick="runCommand('liveStats')">üìà Live Stats</button>
                <button class="admin-btn" onclick="runCommand('getFirebaseStats')">üî• Firebase Stats</button>
                <button class="admin-btn" onclick="runCommand('debugFirebase')">üîç Debug DB</button>
                <button class="admin-btn" onclick="runCommand('listGames')">üéÆ List Games</button>
                <button class="admin-btn" onclick="runCommand('cleanupDuplicates')">üßπ Check Dupes</button>
                <button class="admin-btn" onclick="runCommand('recentSignups')">üìß Signups</button>
                <button class="admin-btn" onclick="runCommand('recentErrors')">üö® Errors</button>
                <button class="admin-btn" onclick="runCommand('viewBugReports')">üêõ Bug Reports</button>
            </div>
            
            <div class="panel-title" style="margin-top: 20px;">üëë ADMIN CONSOLE OUTPUT</div>
            <div class="console-output" id="consoleOutput">
                Commands will appear here...
            </div>
        </div>
    </div>

    <!-- Twitter Automation Panel -->
    <div style="max-width: 1400px; margin: 0 auto; padding: 0 20px 20px;">
        <div class="stats-panel">
            <div class="panel-title">üê¶ TWITTER AUTOMATION</div>
            
            <!-- Twitter Status -->
            <div class="stats-grid" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-label">Twitter Status</div>
                    <div class="stat-value" id="twitterStatus">‚è≥ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">API Keys</div>
                    <div class="stat-value" id="twitterKeys">‚è≥ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Automation</div>
                    <div class="stat-value" id="automationStatus">‚è≥ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Last Tweet</div>
                    <div class="stat-value" id="lastTweet">-</div>
                </div>
            </div>

            <!-- Twitter Controls -->
            <div class="commands-grid">
                <button class="admin-btn" onclick="runTwitterCommand('systemCheck')" style="border-color: #00ffff;">üîç System Check</button>
                <button class="admin-btn" onclick="runTwitterCommand('getAutomationStatus')" style="border-color: #00ffff;">üìä Automation Status</button>
                <button class="admin-btn" onclick="runTwitterCommand('generateDailyTweet')" style="border-color: #00ffff;">üìù Daily Stats</button>
                <button class="admin-btn" onclick="postDailyTweet()" style="border-color: #00ff00;">üì§ Post Daily Tweet</button>
                <button class="admin-btn" onclick="generateNewGameTweet()" style="border-color: #00ff00;">üéÆ New Game Alert</button>
                <button class="admin-btn" onclick="generateGameSpotlight()" style="border-color: #ffff00;">‚≠ê Game Spotlight</button>
                <button class="admin-btn" onclick="generateWeeklyStats()" style="border-color: #00ffff;">üìÖ Weekly Summary</button>
                <button class="admin-btn" onclick="generateRandomRecommendation()" style="border-color: #ff00ff;">üé≤ Random Pick</button>
                <button class="admin-btn" onclick="generateMilestone()" style="border-color: #00ff00;">üèÜ Milestone</button>
                <button class="admin-btn" onclick="generateSitePromo()" style="border-color: #ff00ff;">üöÄ Site Promo</button>
                <button class="admin-btn" onclick="generateVibeCheck()" style="border-color: #ff6b35;">‚ú® Vibe Check</button>
                <button class="admin-btn" onclick="generateChaosUpdate()" style="border-color: #8b00ff;">üå™Ô∏è Chaos Update</button>
                <button class="admin-btn" onclick="generateDevCallout()" style="border-color: #00ff80;">üì¢ Dev Callout</button>
                <button class="admin-btn" onclick="generateFunFact()" style="border-color: #ff1493;">üéØ Fun Fact</button>
                <button class="admin-btn" onclick="runTwitterCommand('enableTwitter')" style="border-color: #00ff00;">‚úÖ Enable Twitter</button>
                <button class="admin-btn" onclick="runTwitterCommand('disableTwitter')" style="border-color: #ff4444;">‚ùå Disable Twitter</button>
                <button class="admin-btn" onclick="runTwitterCommand('testTwitter')" style="border-color: #ffff00;">üß™ Test Connection</button>
            </div>

            <!-- Custom Tweet Input -->
            <div style="margin-top: 20px;">
                <div class="stat-label" style="margin-bottom: 10px;">üìù Send Custom Tweet</div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="customTweetInput" placeholder="Enter your tweet message..." 
                           style="flex: 1; background: rgba(0,0,0,0.8); border: 1px solid #00ff00; color: #00ff00; 
                                  padding: 10px; border-radius: 5px; font-family: 'Courier New', monospace;"
                           maxlength="280">
                    <button class="admin-btn" onclick="sendCustomTweet()" style="border-color: #00ffff; min-width: 100px;">
                        üê¶ TWEET
                    </button>
                </div>
                <div style="font-size: 11px; color: #888; margin-top: 5px;">
                    Character count: <span id="charCount">0</span>/280
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK v11.0.2 (Updated to match main site) -->
    <script type="module">
        // Firebase configuration (same as main site)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';
        import { getFirestore, collection, getDocs, query, where, orderBy, limit, addDoc } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCuaKGPn6_wVD9p56U2MNHuyVBI-CN3o70",
            authDomain: "dumbassgames-c1217.firebaseapp.com",
            projectId: "dumbassgames-c1217",
            storageBucket: "dumbassgames-c1217.firebasestorage.app",
            messagingSenderId: "949393088299",
            appId: "1:949393088299:web:fdd3f0d2f91d7efb7f2a80"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        // Set up the same collection reference as main site
        const firebaseCollection = collection(db, 'games');
        
        // Make Firebase functions available globally (like main site)
        window.firebaseGetDocs = getDocs;
        window.firebaseQuery = query;
        window.firebaseWhere = where;
        window.firebaseOrderBy = orderBy;
        window.firebaseLimit = limit;
        window.firebaseAddDoc = addDoc;
        window.firebaseCollection = (db, collectionName) => collection(db, collectionName);
        window.firebaseDb = db;
        window.db = db;
        window.auth = auth;

        // Check if user is authorized admin
        function isUserAdmin() {
            const currentUser = auth?.currentUser;
            if (!currentUser) return false;
            
            // Debug: Log current user info
            console.log('üîç Dashboard - Current user UID:', currentUser.uid);
            console.log('üîç Dashboard - Current user email:', currentUser.email);
            
            // Admin UIDs - must match main site
            const adminUIDs = [
                'FIMoIezOXMRmkg9bl3ArJGCkuf93', // dumbassgames@proton.me
                // Add other admin UIDs here if needed
            ];
            
            const isAdmin = adminUIDs.includes(currentUser.uid);
            console.log('üîç Dashboard - Is user admin?', isAdmin);
            return isAdmin;
        }

        // Protect admin dashboard access
        async function checkAdminAccess() {
            try {
                console.log('üîç Starting admin access check...');
                
                // Wait longer for auth to initialize and retry multiple times
                let authUser = null;
                let attempts = 0;
                const maxAttempts = 10;
                
                while (!authUser && attempts < maxAttempts) {
                    attempts++;
                    console.log(`üîç Auth check attempt ${attempts}/${maxAttempts}`);
                    
                    authUser = auth.currentUser;
                    
                    if (!authUser) {
                        // Wait for auth state change
                        await new Promise((resolve) => {
                            const unsubscribe = onAuthStateChanged(auth, (user) => {
                                authUser = user;
                                unsubscribe();
                                resolve();
                            });
                            
                            // Also resolve after timeout
                            setTimeout(resolve, 1000);
                        });
                    }
                    
                    if (!authUser) {
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }
                }
                
                console.log('üîç Final auth user:', authUser?.email || 'none');
                
                if (!authUser) {
                    console.warn('üö´ No authenticated user found after retries');
                    document.body.innerHTML = `
                        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ffff00; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                            <h1>‚è≥ AUTHENTICATION LOADING</h1>
                            <p style="margin: 20px 0; color: #00ffff;">Please wait while we verify your credentials...</p>
                            <button onclick="location.reload()" style="background: #00ffff; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">RETRY</button>
                        </div>
                    `;
                    return false;
                }

                if (!isUserAdmin()) {
                    console.warn('üö´ User is authenticated but not admin:', authUser.email);
                    document.body.innerHTML = `
                        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ff4444; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                            <h1>üö´ ACCESS DENIED</h1>
                            <p style="margin: 20px 0; color: #00ffff;">Admin privileges required</p>
                            <p style="margin: 10px 0; color: #666; font-size: 8px;">Signed in as: ${authUser.email}</p>
                            <button onclick="window.close()" style="background: #ff4444; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">CLOSE</button>
                        </div>
                    `;
                    return false;
                }
                
                console.log('‚úÖ Admin access granted for:', authUser.email);
                return true;
            } catch (error) {
                console.error('Auth check failed:', error);
                document.body.innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ff4444; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                        <h1>‚ùå ERROR</h1>
                        <p style="margin: 20px 0; color: #00ffff;">Authentication system error</p>
                        <button onclick="location.reload()" style="background: #ff4444; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">RETRY</button>
                    </div>
                `;
                return false;
            }
        }

        // Lightweight Admin System
        class DashboardAdmin {
            constructor() {
                this.isReady = false;
                this.initialize();
            }

            async initialize() {
                try {
                    // Check admin access first
                    const hasAccess = await checkAdminAccess();
                    if (!hasAccess) {
                        return;
                    }

                    // Test Firebase connection using same method as main site
                    await getDocs(query(firebaseCollection, limit(1)));
                    this.isReady = true;
                    console.log('üî• Dashboard admin system ready!');
                } catch (error) {
                    console.error('‚ùå Firebase connection failed:', error);
                }
            }

            async dailyReport() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const totalGames = gamesSnapshot.size;
                    
                    const report = {
                        date: new Date().toLocaleDateString(),
                        totalGames: totalGames,
                        status: 'Online',
                        lastUpdated: new Date().toLocaleTimeString()
                    };
                    
                    console.group('üìä DAILY REPORT');
                    console.log('Date:', report.date);
                    console.log('Total Games:', report.totalGames);
                    console.log('Status:', report.status);
                    console.log('Last Updated:', report.lastUpdated);
                    console.groupEnd();
                    
                    return `Daily Report Generated - ${totalGames} games in database`;
                } catch (error) {
                    return `Error generating report: ${error.message}`;
                }
            }

            async getFirebaseStats() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => doc.data());
                    
                    const stats = {
                        totalGames: games.length,
                        categories: {},
                        recentGames: games.filter(g => {
                            const gameDate = new Date(g.submittedAt || '2024-01-01');
                            const weekAgo = new Date();
                            weekAgo.setDate(weekAgo.getDate() - 7);
                            return gameDate > weekAgo;
                        }).length
                    };
                    
                    // Count categories
                    games.forEach(game => {
                        const category = game.category || 'unknown';
                        stats.categories[category] = (stats.categories[category] || 0) + 1;
                    });
                    
                    console.group('üî• FIREBASE STATISTICS');
                    console.log('Total Games:', stats.totalGames);
                    console.log('Recent Games (7 days):', stats.recentGames);
                    console.log('Categories:', stats.categories);
                    console.groupEnd();
                    
                    return `Firebase Stats: ${stats.totalGames} total games, ${stats.recentGames} recent`;
                } catch (error) {
                    return `Error fetching stats: ${error.message}`;
                }
            }

            siteHealth() {
                const health = {
                    firebase: this.isReady ? '‚úÖ Connected' : '‚ùå Disconnected',
                    browser: navigator.onLine ? '‚úÖ Online' : '‚ùå Offline',
                    timestamp: new Date().toLocaleTimeString(),
                    userAgent: navigator.userAgent.slice(0, 50) + '...'
                };
                
                console.group('üè• SITE HEALTH CHECK');
                console.log('Firebase:', health.firebase);
                console.log('Browser:', health.browser);
                console.log('Timestamp:', health.timestamp);
                console.log('User Agent:', health.userAgent);
                console.groupEnd();
                
                return `Site Health: Firebase ${this.isReady ? 'OK' : 'ERROR'}, Browser ${navigator.onLine ? 'OK' : 'OFFLINE'}`;
            }

            liveStats() {
                const stats = {
                    pageLoadTime: Math.round(performance.now()),
                    memoryUsage: performance.memory ? Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) : 'Unknown',
                    networkStatus: navigator.onLine ? 'Online' : 'Offline',
                    timestamp: new Date().toLocaleString()
                };
                
                console.group('üìà LIVE STATISTICS');
                console.log('Page Load Time:', stats.pageLoadTime + 'ms');
                console.log('Memory Usage:', stats.memoryUsage + 'MB');
                console.log('Network:', stats.networkStatus);
                console.log('Timestamp:', stats.timestamp);
                console.groupEnd();
                
                return `Live Stats: ${stats.pageLoadTime}ms load time, ${stats.memoryUsage}MB memory`;
            }

            async listGames() {
                try {
                    const gamesSnapshot = await getDocs(query(firebaseCollection, limit(10)));
                    const games = gamesSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    console.group('üéÆ RECENT GAMES (Last 10)');
                    games.forEach(game => {
                        console.log(`${game.title} - ${game.url}`);
                    });
                    console.groupEnd();
                    
                    return `Listed ${games.length} recent games`;
                } catch (error) {
                    return `Error listing games: ${error.message}`;
                }
            }

            async recentSignups() {
                try {
                    console.log('üìß Fetching recent signups...');
                    
                    // Get users from Firebase Auth (if available) or admin_events collection
                    const usersCollection = window.firebaseCollection(window.firebaseDb, 'admin_events');
                    const signupQuery = window.firebaseQuery(
                        usersCollection,
                        window.firebaseWhere('type', '==', 'signup'),
                        window.firebaseOrderBy('timestamp', 'desc'),
                        window.firebaseLimit(10)
                    );
                    
                    const signupSnapshot = await window.firebaseGetDocs(signupQuery);
                    const signups = signupSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    if (signups.length === 0) {
                        // Try to get user profiles instead
                        const profilesCollection = window.firebaseCollection(window.firebaseDb, 'users');
                        const profileQuery = window.firebaseQuery(
                            profilesCollection,
                            window.firebaseOrderBy('joinDate', 'desc'),
                            window.firebaseLimit(5)
                        );
                        
                        const profileSnapshot = await window.firebaseGetDocs(profileQuery);
                        const profiles = profileSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        
                        console.group('üë• RECENT USER PROFILES');
                        profiles.forEach((profile, index) => {
                            const joinDate = new Date(profile.joinDate).toLocaleString();
                            console.log(`${index + 1}. ${profile.email || profile.displayName || 'Unknown'} - Joined: ${joinDate}`);
                        });
                        console.groupEnd();
                        
                        // Also add to dashboard output
                        const output = document.getElementById('consoleOutput');
                        if (output) {
                            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üë• RECENT USER PROFILES:</div>`;
                            profiles.forEach((profile, index) => {
                                const joinDate = new Date(profile.joinDate).toLocaleString();
                                const displayName = profile.email || profile.displayName || 'Unknown';
                                output.innerHTML += `<div style="color: #888;">${index + 1}. ${displayName} - Joined: ${joinDate}</div>`;
                            });
                            output.scrollTop = output.scrollHeight;
                        }
                        
                        return `Found ${profiles.length} recent user profiles`;
                    }
                    
                    console.group('üìß RECENT SIGNUPS');
                    signups.forEach((signup, index) => {
                        const signupTime = new Date(signup.timestamp).toLocaleString();
                        console.log(`${index + 1}. ${signup.data?.email || signup.email || 'Unknown'} - ${signupTime}`);
                        if (signup.data?.referrer) {
                            console.log(`   üìç Referrer: ${signup.data.referrer}`);
                        }
                    });
                    console.groupEnd();
                    
                    // Also add to dashboard output
                    const output = document.getElementById('consoleOutput');
                    if (output) {
                        output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üìß RECENT SIGNUPS:</div>`;
                        signups.forEach((signup, index) => {
                            const signupTime = new Date(signup.timestamp).toLocaleString();
                            const email = signup.data?.email || signup.email || 'Unknown';
                            output.innerHTML += `<div style="color: #888;">${index + 1}. ${email} - ${signupTime}</div>`;
                            if (signup.data?.referrer) {
                                output.innerHTML += `<div style="color: #666;">   üìç Referrer: ${signup.data.referrer}</div>`;
                            }
                        });
                        output.scrollTop = output.scrollHeight;
                    }
                    
                    return `Found ${signups.length} recent signups`;
                } catch (error) {
                    console.warn('Error fetching signups:', error);
                    return `Error fetching signups: ${error.message}`;
                }
            }

            async recentErrors() {
                try {
                    console.log('üö® Fetching recent errors...');
                    
                    // Get errors from admin_events collection
                    const eventsCollection = window.firebaseCollection(window.firebaseDb, 'admin_events');
                    const errorQuery = window.firebaseQuery(
                        eventsCollection,
                        window.firebaseWhere('type', '==', 'error'),
                        window.firebaseOrderBy('timestamp', 'desc'),
                        window.firebaseLimit(10)
                    );
                    
                    const errorSnapshot = await window.firebaseGetDocs(errorQuery);
                    const errors = errorSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    if (errors.length === 0) {
                        console.log('‚úÖ No recent errors found - site is running smoothly!');
                        
                        // Also add to dashboard output
                        const output = document.getElementById('consoleOutput');
                        if (output) {
                            output.innerHTML += `<div style="color: #00ff00; margin-top: 10px;">‚úÖ No recent errors found - site is healthy!</div>`;
                            output.scrollTop = output.scrollHeight;
                        }
                        
                        return 'No recent errors found - site is healthy! ‚úÖ';
                    }
                    
                    console.group('üö® RECENT ERRORS');
                    errors.forEach((error, index) => {
                        const errorTime = new Date(error.timestamp).toLocaleString();
                        console.log(`${index + 1}. ${error.data?.message || error.message || 'Unknown error'} - ${errorTime}`);
                        if (error.data?.stack) {
                            console.log(`   üìç Stack: ${error.data.stack.substring(0, 100)}...`);
                        }
                        if (error.data?.userAgent) {
                            console.log(`   üñ•Ô∏è Browser: ${error.data.userAgent.substring(0, 50)}...`);
                        }
                    });
                    console.groupEnd();
                    
                    // Also add to dashboard output
                    const output = document.getElementById('consoleOutput');
                    if (output) {
                        output.innerHTML += `<div style="color: #ff4444; margin-top: 10px;">üö® RECENT ERRORS:</div>`;
                        errors.forEach((error, index) => {
                            const errorTime = new Date(error.timestamp).toLocaleString();
                            const message = error.data?.message || error.message || 'Unknown error';
                            output.innerHTML += `<div style="color: #888;">${index + 1}. ${message} - ${errorTime}</div>`;
                            if (error.data?.stack) {
                                output.innerHTML += `<div style="color: #666;">   üìç Stack: ${error.data.stack.substring(0, 100)}...</div>`;
                            }
                            if (error.data?.userAgent) {
                                output.innerHTML += `<div style="color: #666;">   üñ•Ô∏è Browser: ${error.data.userAgent.substring(0, 50)}...</div>`;
                            }
                        });
                        output.scrollTop = output.scrollHeight;
                    }
                    
                    return `Found ${errors.length} recent errors`;
                } catch (error) {
                    console.warn('Error fetching errors:', error);
                    return `Error fetching error logs: ${error.message}`;
                }
            }

            searchAnalytics() {
                console.log('üîç Search analytics are available on the main site');
                return 'Search analytics require the main site to be running';
            }

            async cleanupDuplicates() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    const titleMap = {};
                    let duplicates = 0;
                    
                    games.forEach(game => {
                        const title = game.title?.toLowerCase().trim();
                        if (title) {
                            if (titleMap[title]) {
                                duplicates++;
                            } else {
                                titleMap[title] = game;
                            }
                        }
                    });
                    
                    return `Found ${duplicates} potential duplicates (use main site for actual cleanup)`;
                } catch (error) {
                    return `Error checking duplicates: ${error.message}`;
                }
            }

            async debugFirebase() {
                try {
                    console.group('üîç FIREBASE DEBUG');
                    
                    // Show Firebase project info
                    console.log('üèóÔ∏è Firebase Project ID:', window.db.app.options.projectId);
                    console.log('üèóÔ∏è Firebase Auth Domain:', window.db.app.options.authDomain);
                    console.log('üèóÔ∏è Full Config:', window.db.app.options);
                    
                    // Check basic connection
                    console.log('üì° Testing Firebase connection...');
                    const testSnapshot = await getDocs(query(firebaseCollection, limit(1)));
                    console.log('‚úÖ Firebase connection successful');
                    
                    // Get all collections to see what exists
                    console.log('üìã Checking games collection...');
                    const allGamesSnapshot = await getDocs(firebaseCollection);
                    console.log(`üìä Total documents in 'games' collection: ${allGamesSnapshot.size}`);
                    
                    // Log first few games
                    if (allGamesSnapshot.size > 0) {
                        console.log('üéÆ Sample games:');
                        allGamesSnapshot.docs.slice(0, 3).forEach((doc, i) => {
                            const data = doc.data();
                            console.log(`${i + 1}. ${data.title || 'No title'} - ${data.url || 'No URL'}`);
                        });
                    } else {
                        console.log('‚ùå No documents found in games collection');
                        
                        // Check if games might be in localStorage instead
                        const localStorageGames = localStorage.getItem('dumbassGames') || localStorage.getItem('games');
                        if (localStorageGames) {
                            const parsedGames = JSON.parse(localStorageGames);
                            console.log(`üíæ Found ${parsedGames.length || 0} games in localStorage`);
                            console.log('üìã Local games:', parsedGames.slice(0, 3).map(g => g.title || 'No title'));
                        } else {
                            console.log('üíæ No games found in localStorage either');
                        }
                    }
                    
                    console.groupEnd();
                    
                    return `Debug complete - ${allGamesSnapshot.size} games in Firebase, check console for details`;
                } catch (error) {
                    console.error('‚ùå Firebase debug error:', error);
                    return `Debug failed: ${error.message}`;
                }
            }

            async viewBugReports(output) {
                console.log('üìã Viewing bug reports...');
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    console.group('üêõ BUG REPORTS');
                    games.forEach(game => {
                        console.log(`${game.title} - ${game.description || 'No description'}`);
                    });
                    console.groupEnd();
                    
                    return `Viewed ${games.length} bug reports`;
                } catch (error) {
                    return `Error viewing bug reports: ${error.message}`;
                }
            }
        }

        // Create dashboard admin instance
        window.dumbassGameAdmin = new DashboardAdmin();
        
        // Wait for initialization
        const waitForInit = async () => {
            if (window.dumbassGameAdmin.isReady) {
                console.log('‚úÖ Dashboard admin system ready!');
                if (window.updateDashboardStats) {
                    await window.updateDashboardStats();
                }
            } else {
                setTimeout(waitForInit, 1000);
            }
        };
        
        setTimeout(waitForInit, 1000);
    </script>

    <script>
        let consoleDiv = document.getElementById('consoleOutput');
        
        function runCommand(commandName) {
            const output = document.getElementById('consoleOutput');
            
            // Add command to output
            output.innerHTML += `<div style="color: #ffff00; margin-top: 10px;">‚Üí ${commandName}()</div>`;
            
            try {
                let result;
                
                // Wait for admin system to be ready
                if (!window.dumbassGameAdmin) {
                    output.innerHTML += `<div style="color: #ffff00;">‚è≥ Initializing admin system...</div>`;
                    
                    // Wait a bit for scripts to load
                    setTimeout(() => {
                        runCommand(commandName);
                    }, 2000);
                    return;
                }
                
                // Handle bug reports command
                if (commandName === 'viewBugReports') {
                    handleViewBugReports(output);
                    return;
                }
                
                if (window.dumbassGameAdmin && window.dumbassGameAdmin[commandName]) {
                    // Special handling for async commands
                    if (commandName === 'recentSignups' || commandName === 'recentErrors') {
                        // Show loading indicator
                        output.innerHTML += `<div style="color: #ffff00;">‚è≥ Loading ${commandName === 'recentSignups' ? 'signups' : 'errors'}...</div>`;
                        
                        // Call async function
                        window.dumbassGameAdmin[commandName]().then(res => {
                            output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${res}</div>`;
                            output.scrollTop = output.scrollHeight;
                        }).catch(err => {
                            output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${err}</div>`;
                            output.scrollTop = output.scrollHeight;
                        });
                        return; // Exit early for async commands
                    } else {
                        result = window.dumbassGameAdmin[commandName]();
                    }
                } else {
                    result = `‚ùå Command "${commandName}" not found in admin system`;
                }
                
                if (result && result.then) {
                    // Handle promises
                    result.then(res => {
                        output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${res}</div>`;
                        output.scrollTop = output.scrollHeight;
                    }).catch(err => {
                        output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${err}</div>`;
                        output.scrollTop = output.scrollHeight;
                    });
                } else {
                    output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${result}</div>`;
                }
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            
            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
        }
        
        async function handleViewBugReports(output) {
            output.innerHTML += `<div style="color: #00ffff;">üêõ Loading bug reports from Firebase...</div>`;
            
            try {
                if (!window.firebaseDb || !window.firebaseCollection) {
                    throw new Error('Firebase not available');
                }
                
                // Get bugs collection
                const bugsCollection = window.firebaseCollection(window.firebaseDb, 'bugs');
                const bugsSnapshot = await window.firebaseGetDocs(bugsCollection);
                
                if (bugsSnapshot.empty) {
                    output.innerHTML += `<div style="color: #ffff00;">üìã No bug reports found</div>`;
                    output.innerHTML += `<div style="color: #888;">Users can submit bug reports via the footer button</div>`;
                    return;
                }
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Found ${bugsSnapshot.size} bug reports:</div>`;
                output.innerHTML += `<div style="color: #00ffff;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>`;
                
                let reportCount = 0;
                bugsSnapshot.forEach((doc) => {
                    const bug = doc.data();
                    reportCount++;
                    
                    // Format timestamp
                    const timestamp = bug.timestamp ? new Date(bug.timestamp).toLocaleString() : 'Unknown';
                    
                    // Get severity color
                    let severityColor = '#ffff00';
                    if (bug.severity === 'low') severityColor = '#00ff00';
                    else if (bug.severity === 'high') severityColor = '#ff8800';
                    else if (bug.severity === 'critical') severityColor = '#ff4444';
                    
                    output.innerHTML += `<div style="color: #00ff00; margin-top: 15px;">üêõ Report #${reportCount} - ${bug.id || doc.id}</div>`;
                    output.innerHTML += `<div style="color: #ffff00;">üìÖ ${timestamp}</div>`;
                    output.innerHTML += `<div style="color: #ffffff;"><strong>Title:</strong> ${bug.title || 'No title'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>Category:</strong> ${bug.category || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: ${severityColor};"><strong>Severity:</strong> ${bug.severity || 'medium'}</div>`;
                    output.innerHTML += `<div style="color: #cccccc;"><strong>Description:</strong> ${bug.description || 'No description'}</div>`;
                    
                    if (bug.steps) {
                        output.innerHTML += `<div style="color: #aaaaaa;"><strong>Steps:</strong> ${bug.steps}</div>`;
                    }
                    
                    output.innerHTML += `<div style="color: #888;"><strong>Browser:</strong> ${bug.browser || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>Device:</strong> ${bug.device || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>User:</strong> ${bug.userEmail || 'Anonymous'}</div>`;
                    
                    if (bug.contact) {
                        output.innerHTML += `<div style="color: #00ffff;"><strong>Contact:</strong> ${bug.contact}</div>`;
                    }
                    
                    output.innerHTML += `<div style="color: #666;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>`;
                });
                
                output.innerHTML += `<div style="color: #00ff00; margin-top: 10px;">‚úÖ Displayed ${reportCount} bug reports</div>`;
                output.innerHTML += `<div style="color: #00ffff;">üí° Tip: Use browser dev tools to copy bug details</div>`;
                
            } catch (error) {
                console.error('‚ùå Error loading bug reports:', error);
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error loading bug reports: ${error.message}</div>`;
                output.innerHTML += `<div style="color: #ffff00;">üîß Make sure Firebase is connected and user is authenticated</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }
        
        async function updateDashboardStats() {
            try {
                // Update site status
                const siteStatus = document.getElementById('siteStatus');
                if (navigator.onLine && window.dumbassGameAdmin?.isReady) {
                    siteStatus.textContent = '‚úÖ ONLINE';
                    siteStatus.style.color = '#00ff00';
                } else {
                    siteStatus.textContent = '‚è≥ LOADING';
                    siteStatus.style.color = '#ffff00';
                }
                
                // Update total games from Firebase using same method as main site
                if (window.dumbassGameAdmin?.isReady && window.firebaseCollection && window.firebaseDb) {
                    try {
                        const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                        const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                        document.getElementById('totalGames').textContent = gamesSnapshot.size;
                    } catch (error) {
                        console.error('Error getting games count:', error);
                        document.getElementById('totalGames').textContent = 'Error';
                    }
                }
                
                // Update users online (basic estimate)
                const usersOnline = window.auth?.currentUser ? 1 : 0;
                document.getElementById('usersOnline').textContent = usersOnline;
                
                // Update top search (placeholder)
                document.getElementById('topSearch').textContent = 'Use main site';
                
            } catch (error) {
                console.warn('Dashboard update error:', error);
            }
        }
        
        // Update stats every 30 seconds
        setInterval(updateDashboardStats, 30000);

        // Twitter Automation Functions
        function runTwitterCommand(command) {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üê¶ ${command}()</div>`;
            
            try {
                let result = '';
                
                // Try local Twitter integration first, then fallback to main window
                if (window.TwitterAPI) {
                    switch(command) {
                        case 'systemCheck':
                            result = `üîç System Check:\n‚Ä¢ Twitter API: ${window.TwitterAPI.isConfigured ? '‚úÖ Configured' : '‚ùå Not configured'}\n‚Ä¢ Admin Dashboard: ‚úÖ Ready`;
                            break;
                        case 'getAutomationStatus':
                            result = `üìä Automation Status:\n‚Ä¢ Twitter Integration: ${window.TwitterAPI.isConfigured ? '‚úÖ Ready' : '‚ùå Needs API keys'}\n‚Ä¢ Auto-posting: ${window.TwitterAPI.isConfigured ? 'üü° Ready for activation' : '‚ùå Disabled'}`;
                            break;
                        case 'generateDailyTweet':
                            handleGenerateDailyTweet(output);
                            return; // Handle async
                            break;
                        case 'enableTwitter':
                            result = '‚úÖ Twitter integration enabled! (Standalone mode)';
                            break;
                        case 'disableTwitter':
                            result = '‚ùå Twitter integration disabled! (Standalone mode)';
                            break;
                        case 'testTwitter':
                            handleTestTwitter(output);
                            return; // Handle async
                        default:
                            result = `Unknown command: ${command}`;
                    }
                } else {
                    // Check if we can access the main site's admin system
                    const mainWindow = window.opener || window.parent;
                    
                    if (mainWindow && mainWindow.dumbassGameAdmin) {
                        // Use main site's admin system
                        switch(command) {
                            case 'systemCheck':
                                result = mainWindow.dumbassGameAdmin.systemCheck();
                                break;
                            case 'getAutomationStatus':
                                result = mainWindow.dumbassGameAdmin.getAutomationStatus();
                                break;
                            case 'generateDailyTweet':
                                result = mainWindow.dumbassGameAdmin.generateDailyTweet();
                                break;
                            case 'enableTwitter':
                                result = mainWindow.dumbassGameAdmin.enableTwitterIntegration();
                                break;
                            case 'disableTwitter':
                                result = mainWindow.dumbassGameAdmin.disableTwitterIntegration();
                                break;
                            case 'testTwitter':
                                result = mainWindow.dumbassGameAdmin.testTwitter ? 
                                        mainWindow.dumbassGameAdmin.testTwitter() : 
                                        'Test function not available';
                                break;
                            default:
                                result = `Unknown command: ${command}`;
                        }
                    } else {
                        // Provide instructions if main site isn't accessible
                        result = `üîó Twitter integration loading... Please wait or open from main site (localhost:8000)`;
                    }
                }
                
                if (result && result.then) {
                    // Handle promises
                    result.then(res => {
                        output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${res}</div>`;
                        output.scrollTop = output.scrollHeight;
                        updateTwitterStatus();
                    }).catch(err => {
                        output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${err}</div>`;
                        output.scrollTop = output.scrollHeight;
                    });
                } else {
                    output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${result}</div>`;
                    updateTwitterStatus();
                }
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        function sendCustomTweet() {
            const input = document.getElementById('customTweetInput');
            const message = input.value.trim();
            
            if (!message) {
                alert('Please enter a tweet message!');
                return;
            }
            
            if (message.length > 280) {
                alert('Tweet is too long! Maximum 280 characters.');
                return;
            }
            
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üê¶ Opening Twitter with Custom Tweet</div>`;
            
            try {
                // Create Twitter Web Intent URL
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&hashtags=DumbassGames,RetroGaming`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Twitter opened with message: "${message}"</div>`;
                output.innerHTML += `<div style="color: #00ffff;">üîó Complete the tweet on Twitter.com</div>`;
                
                // Clear input after success
                input.value = '';
                updateCharCount();
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        function updateCharCount() {
            const input = document.getElementById('customTweetInput');
            const charCount = document.getElementById('charCount');
            const count = input.value.length;
            
            charCount.textContent = count;
            charCount.style.color = count > 280 ? '#ff4444' : count > 250 ? '#ffff00' : '#888';
        }

        // Helper functions for standalone Twitter integration
        async function generateDailyTweetPreview() {
            const now = new Date();
            const dateStr = now.toLocaleDateString();
            
            try {
                // Fetch real data from Firebase
                const output = document.getElementById('consoleOutput');
                output.innerHTML += `<div style="color: #ffff00;">üìä Fetching real data from Firebase...</div>`;
                
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Calculate real stats
                const totalGames = games.length;
                const last24Hours = new Date();
                last24Hours.setDate(last24Hours.getDate() - 1);
                
                // Count recent games (last 7 days as proxy for "games played")
                const recentGames = games.filter(game => {
                    const gameDate = game.submittedAt ? new Date(game.submittedAt) : new Date('2024-01-01');
                    return gameDate > last24Hours;
                });
                
                // Find most popular game (by play count or most recent)
                let topGame = 'Retro Adventure';
                if (games.length > 0) {
                    // Sort by play count if available, otherwise by submission date
                    const sortedGames = games.sort((a, b) => {
                        const aPlays = a.playCount || 0;
                        const bPlays = b.playCount || 0;
                        if (aPlays !== bPlays) return bPlays - aPlays;
                        
                        const aDate = new Date(a.submittedAt || '2024-01-01');
                        const bDate = new Date(b.submittedAt || '2024-01-01');
                        return bDate - aDate;
                    });
                    topGame = sortedGames[0]?.title || 'Retro Adventure';
                }
                
                // Generate realistic stats
                const gamesPlayed = Math.max(totalGames * 2, recentGames.length * 10 + Math.floor(Math.random() * 50));
                const newGamers = recentGames.length + Math.floor(Math.random() * 5);
                
                const dailyTweet = `üìä 24 HOURS AT DUMBASSGAMES:\nüéÆ ${gamesPlayed} games played\nüë• ${newGamers} new gamers joined\nüèÜ Top game: ${topGame}\nüïπÔ∏è Pure retro fun at dumbassgames.xyz\n#DailyStats #RetroGaming`;
                
                // Store the generated tweet for easy posting
                window.lastGeneratedTweet = dailyTweet;
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Real data loaded: ${totalGames} total games, ${recentGames.length} recent</div>`;
                
                return `üìä Daily Tweet Preview for ${dateStr}:\n\n"${dailyTweet}"\n\nüìà Real Stats: ${totalGames} total games in database\nüí° Click "Post Daily Tweet" button to send this to Twitter!`;
                
            } catch (error) {
                console.error('Error fetching real data:', error);
                
                // Fallback to placeholder data if Firebase fails
                const dailyTweet = `üìä 24 HOURS AT DUMBASSGAMES:\nüéÆ Gaming stats loading...\nüë• Community growing!\nüèÜ Top game: Check dumbassgames.xyz\nüïπÔ∏è Pure retro fun at dumbassgames.xyz\n#DailyStats #RetroGaming`;
                
                window.lastGeneratedTweet = dailyTweet;
                
                return `üìä Daily Tweet Preview for ${dateStr}:\n\n"${dailyTweet}"\n\n‚ö†Ô∏è Using fallback data (Firebase error: ${error.message})`;
            }
        }

        function handleTestTwitter(output) {
            output.innerHTML += `<div style="color: #ffff00;">üß™ Opening Twitter for test tweet...</div>`;
            
            try {
                const testMessage = 'üéÆ Testing DUMBASSGAMES automation! dumbassgames.xyz #RetroGaming #TestTweet';
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(testMessage)}`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Twitter opened with test message!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">üîó Complete the test tweet on Twitter.com</div>`;
                output.innerHTML += `<div style="color: #888;">üí° This confirms your browser can open Twitter - connection working!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error opening Twitter: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
            updateTwitterStatus();
        }

        async function handleGenerateDailyTweet(output) {
            try {
                const result = await generateDailyTweetPreview();
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ ${result}</div>`;
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error generating daily tweet: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        async function postDailyTweet() {
            const output = document.getElementById('consoleOutput');
            
            // Check if we have a generated tweet
            if (!window.lastGeneratedTweet) {
                output.innerHTML += `<div style="color: #ffff00; margin-top: 10px;">üìù Generating fresh daily tweet with real data...</div>`;
                // Generate a new one with real data
                try {
                    await generateDailyTweetPreview();
                } catch (error) {
                    output.innerHTML += `<div style="color: #ff4444;">‚ùå Error generating tweet: ${error.message}</div>`;
                    // Fallback tweet
                    window.lastGeneratedTweet = `üìä 24 HOURS AT DUMBASSGAMES:\nüéÆ Gaming stats loading...\nüë• Community growing!\nüèÜ Check out dumbassgames.xyz\nüïπÔ∏è Pure retro fun!\n#DailyStats #RetroGaming`;
                }
            }
            
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üì§ Opening Twitter with Daily Tweet</div>`;
            
            try {
                // Create Twitter Web Intent URL with the daily tweet
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(window.lastGeneratedTweet)}`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Twitter opened with daily tweet!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">üîó Complete the daily tweet on Twitter.com</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        // New Game Alert Tweet
        async function generateNewGameTweet() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üéÆ Generating New Game Alert</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Get most recent game
                const recentGames = games.sort((a, b) => {
                    const aDate = new Date(a.submittedAt || '2024-01-01');
                    const bDate = new Date(b.submittedAt || '2024-01-01');
                    return bDate - aDate;
                });
                
                const newestGame = recentGames[0];
                let tweetText;
                
                if (newestGame) {
                    tweetText = `üéÆ NEW GAME ALERT! "${newestGame.title}" just joined our retro arcade!\n\n${newestGame.description || 'Pure chaotic gaming goodness!'}\n\nüïπÔ∏è Play now at dumbassgames.xyz\n#NewGame #RetroGaming #IndieGames`;
                } else {
                    tweetText = `üéÆ NEW GAMES WANTED! Submit your weird, wonderful, and chaotic creations to our retro arcade!\n\nüïπÔ∏è dumbassgames.xyz\n#GameDev #RetroGaming #IndieGames`;
                }
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ New Game Alert opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Game Spotlight Tweet
        async function generateGameSpotlight() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">‚≠ê Generating Game Spotlight</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                if (games.length === 0) {
                    throw new Error('No games found in database');
                }
                
                // Pick a random game to spotlight
                const spotlightGame = games[Math.floor(Math.random() * games.length)];
                
                const adjectives = ['chaotic', 'cursed', 'blessed', 'unhinged', 'galaxy brain', 'peak dumbass', 'vibe coded', 'beautifully broken', 'digitally abominable'];
                const randomAdjective = adjectives[Math.floor(Math.random() * adjectives.length)];
                
                const tweetText = `‚≠ê GAME SPOTLIGHT: "${spotlightGame.title}"\n\n${spotlightGame.description || 'A wild digital abomination!'}\n\nüéØ Why we love it: Pure ${randomAdjective} energy!\nüíÄ This is what we call "vibe coded perfection"\n\nüïπÔ∏è Play at dumbassgames.xyz\n#GameSpotlight #VibeGames #DigitalChaos`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Game Spotlight for "${spotlightGame.title}" opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Weekly Summary Tweet
        async function generateWeeklyStats() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üìÖ Generating Weekly Summary</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Calculate weekly stats
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                
                const weeklyGames = games.filter(game => {
                    const gameDate = new Date(game.submittedAt || '2024-01-01');
                    return gameDate > weekAgo;
                });
                
                const totalGames = games.length;
                const weeklySubmissions = weeklyGames.length;
                
                const chaosLevels = {
                    high: 'MAXIMUM OVERDRIVE üå™Ô∏è',
                    medium: 'beautifully chaotic üí´', 
                    low: 'ready for more digital abominations üíÄ'
                };
                
                const chaosLevel = weeklySubmissions > 3 ? chaosLevels.high : 
                                 weeklySubmissions > 0 ? chaosLevels.medium : chaosLevels.low;
                
                const tweetText = `üìÖ WEEKLY CHAOS REPORT:\n\nüéÆ ${totalGames} total digital abominations\nüìù ${weeklySubmissions} new vibe coded games this week\nüî• Chaos level: ${chaosLevel}\nüíÄ No gatekeeping, just pure vibes\n\nüïπÔ∏è Submit your weird creation at dumbassgames.xyz\n#WeeklyStats #VibeGames #DigitalChaos`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Weekly Summary opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Random Game Recommendation
        async function generateRandomRecommendation() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üé≤ Generating Random Pick</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                if (games.length === 0) {
                    throw new Error('No games found in database');
                }
                
                const randomGame = games[Math.floor(Math.random() * games.length)];
                const vibes = ['cursed but blessed', 'chaotically perfect', 'peak dumbass energy', 'galaxy brain chaos', 'unhinged excellence', 'digitally abominable', 'vibe coded perfection', 'beautifully broken'];
                const randomVibe = vibes[Math.floor(Math.random() * vibes.length)];
                
                const descriptions = [
                    'No description needed - just pure digital chaos!',
                    'The kind of game that shouldn\'t exist, but we\'re glad it does',
                    'Vibe coded perfection in its natural habitat',
                    'This is what happens when chaos meets creativity',
                    'A beautiful disaster waiting to be discovered'
                ];
                
                const randomDescription = descriptions[Math.floor(Math.random() * descriptions.length)];
                
                const tweetText = `üé≤ CHAOS ROULETTE:\n\n"${randomGame.title}"\n\nüéØ Vibe: ${randomVibe}\nüí≠ ${randomGame.description || randomDescription}\n\nüéÆ Feeling chaotic? Play it at dumbassgames.xyz\n#ChaosRoulette #VibeGames #DigitalAbomination`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Random Pick "${randomGame.title}" opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Milestone Tweet
        async function generateMilestone() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üèÜ Generating Milestone Tweet</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                // Determine milestone
                let milestone, message;
                if (totalGames >= 100) {
                    milestone = 'üíØ 100+ GAMES';
                    message = 'We\'ve officially hit TRIPLE DIGITS! The arcade is STACKED!';
                } else if (totalGames >= 50) {
                    milestone = 'üî• 50+ GAMES';
                    message = 'Half a century of pure gaming chaos!';
                } else if (totalGames >= 25) {
                    milestone = 'üéØ 25+ GAMES';
                    message = 'Quarter-century of retro goodness!';
                } else if (totalGames >= 10) {
                    milestone = 'üöÄ 10+ GAMES';
                    message = 'Double digits, baby! The collection grows!';
                } else {
                    milestone = 'üå± GROWING COLLECTION';
                    message = `${totalGames} games and counting! Submit yours!`;
                }
                
                const tweetText = `üèÜ MILESTONE ACHIEVED: ${milestone}\n\nüéâ ${message}\n\nüéÆ ${totalGames} games of pure retro insanity\nüë• Powered by an amazing community\n\nüïπÔ∏è Join the chaos at dumbassgames.xyz\n#Milestone #RetroGaming #Community`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Milestone tweet (${totalGames} games) opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Vibe Check Tweet
        async function generateVibeCheck() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">‚ú® Generating Vibe Check Tweet</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                const vibes = [
                    'cursed but blessed', 'chaotically perfect', 'beautifully broken', 
                    'peak dumbass energy', 'galaxy brain chaos', 'unhinged excellence',
                    'digitally abominable', 'gloriously failing', 'vibe coded perfection',
                    'spectacularly unhinged', 'criminally underrated', 'blessing in disguise',
                    'certified digital chaos', 'premium grade nonsense', 'artistically terrible',
                    'transcendently broken', 'professionally unprofessional', 'academically unserious',
                    'deliberately accidental', 'intentionally confused', 'strategically chaotic',
                    'expertly amateur', 'scientifically unscientific', 'logically illogical',
                    'magnificently cursed', 'divinely dumb', 'wonderfully weird',
                    'fantastically flawed', 'splendidly broken', 'delightfully chaotic'
                ];
                
                const randomVibe = vibes[Math.floor(Math.random() * vibes.length)];
                const totalGames = games.length;
                
                const vibeCheckTweets = [
                    `‚ú® VIBE CHECK: How's your chaos energy today? üå™Ô∏è\n\nüéÆ We've got ${totalGames} games of pure ${randomVibe}\nüíÄ Digital abominations? ‚úÖ\nüî• Glorious failures? ‚úÖ\n‚ö° 60-second submissions? ‚úÖ\n\nüïπÔ∏è Submit your vibe at dumbassgames.xyz\n#VibeCheck #ChaosGaming`,
                    
                    `üéØ DAILY VIBE: ${randomVibe} üí´\n\n‚ú® Current chaos level: MAXIMUM\nüéÆ Games that hit different: ${totalGames}+\nüíÄ Your weird game belongs here\n‚ö° No gatekeeping, just pure vibes\n\nüöÄ dumbassgames.xyz\n#Vibes #DigitalChaos`,
                    
                    `üå™Ô∏è CHAOS ENERGY REPORT üìä\n\n‚úÖ Vibe: ${randomVibe}\n‚úÖ Games: ${totalGames} digital abominations\n‚úÖ Gatekeeping: Absolutely none\n‚úÖ Fun guaranteed: 100%\n\nüéÆ What's your vibe? Add it to the collection!\nüëâ dumbassgames.xyz\n#VibeCheck`,
                    
                    `üî• VIBE METER READING: ${randomVibe.toUpperCase()} üìà\n\nüéÆ Collection status: ${totalGames} beautiful disasters\nüí´ Quality control: We don't know her\n‚ö° Submission barrier: What barrier?\n‚ú® Your weird creation needed: YES\n\nüöÄ dumbassgames.xyz\n#VibeReading #DigitalChaos`,
                    
                    `üí´ TODAY'S ENERGY: ${randomVibe} vibes only üéÆ\n\nüåü Currently hosting ${totalGames} digital monstrosities\nüíÄ Cursed content? We love it\nüî• Blessed disasters? Even better\n‚ö° Upload time: Still under 60 seconds\n\n‚ú® dumbassgames.xyz\n#VibeEnergy #ChaosGaming`,
                    
                    `üéÆ CHAOS BAROMETER: ${randomVibe} detected! üå™Ô∏è\n\nüìä Current inventory: ${totalGames} vibe coded masterpieces\nüíÄ Sanity level: Not found\nüî• Fun level: Off the charts\n‚ö° Barrier to entry: None whatsoever\n\nüöÄ dumbassgames.xyz\n#ChaosBarometer #VibeGames`
                ];
                
                const randomTweet = vibeCheckTweets[Math.floor(Math.random() * vibeCheckTweets.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Vibe Check tweet opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Chaos Update Tweet
        async function generateChaosUpdate() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üå™Ô∏è Generating Chaos Update</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                const chaosUpdates = [
                    `üå™Ô∏è CHAOS STATUS UPDATE üìä\n\nüíÄ Digital abominations catalogued: ${totalGames}\nüî• Glorious failures archived: ALL OF THEM\n‚ö° Submission time: Still under 60 seconds\nüéØ Sanity level: Not guaranteed\n\nüéÆ Join the beautiful chaos at dumbassgames.xyz\n#ChaosUpdate`,
                    
                    `üì¢ BREAKING: Local platform contains ${totalGames} games of pure chaos! üéÆ\n\n‚ú® Vibe coded monstrosities? ‚úÖ\nüíÄ Cursed but blessed content? ‚úÖ\nüåü Zero gatekeeping policy? ‚úÖ\n‚ö° 60-second game uploads? ‚úÖ\n\nüöÄ dumbassgames.xyz - where chaos thrives\n#DigitalChaos`,
                    
                    `üéÆ CHAOS LEVEL: MAXIMUM OVERDRIVE üí´\n\nüî• Current collection: ${totalGames} beautiful disasters\nüíÄ Quality control: What's that?\n‚ú® Vibe requirement: Just exist\n‚ö° Upload barrier: Literally none\n\nüëâ Add to the chaos: dumbassgames.xyz\n#ChaosGaming`,
                    
                    `‚ö° URGENT UPDATE: Chaos levels reaching critical mass! üö®\n\nüìä Abomination count: ${totalGames} and rising\nüå™Ô∏è Vibe coded disasters: Infinite\nüíÄ Approval process: Still doesn't exist\nüî• Submission speed: Faster than your regrets\n\nüéÆ dumbassgames.xyz\n#ChaosAlert`,
                    
                    `üîä PLATFORM ANNOUNCEMENT: We're officially unhinged! üíÄ\n\nüéÆ ${totalGames} games of questionable decisions\n‚ú® Zero quality gates, maximum chaos gates\n‚ö° Upload your digital crime in 60 seconds\nüåü We said yes to everything, and we're not sorry\n\nüöÄ dumbassgames.xyz\n#UnhingedUpdate`,
                    
                    `üí´ CHAOS METRICS REPORT: Everything is on fire! üî•\n\nüìà Collection growth: ${totalGames} beautiful mistakes\nüéØ Rejection rate: 0% (we're not monsters)\nüíÄ Average submission quality: Perfectly imperfect\n‚ö° Time to regret your upload: Immediate\n\nüéÆ dumbassgames.xyz\n#ChaosMetrics`,
                    
                    `üå™Ô∏è SYSTEM STATUS: Beautifully broken as intended üíé\n\nüéÆ Games that shouldn't exist: ${totalGames}\n‚ú® Games we're glad exist anyway: Also ${totalGames}\nüíÄ Cursed content warnings: We gave up\nüî• Blessed disaster counter: Off the charts\n\nüöÄ dumbassgames.xyz\n#SystemChaos`
                ];
                
                const randomTweet = chaosUpdates[Math.floor(Math.random() * chaosUpdates.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Chaos Update opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Developer Callout Tweet
        async function generateDevCallout() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üì¢ Generating Dev Callout</div>`;
            
            const devCallouts = [
                `üì¢ CALLING ALL DEVS! üéÆ\n\nü§î Got a game that's "finished" but cursed?\nüí° Built something weird in a game jam?\nüî• Created digital chaos that somehow works?\n‚ö° Have a URL? That's literally our only requirement!\n\n‚ú® dumbassgames.xyz - 60 second submissions\n#GameDev #IndieGames`,
                
                `üéØ ATTENTION GAME CREATORS! üí´\n\n‚úÖ Your game doesn't need to be "good"\n‚úÖ Weird, broken, or bizarre? PERFECT\n‚úÖ Made in 5 minutes? Upload it anyway\n‚úÖ Got a working URL? You're already qualified\n\nüöÄ No gatekeeping at dumbassgames.xyz\n#GameDev #VibeGames`,
                
                `üíÄ DIGITAL ABOMINATION COLLECTORS WANTED! üéÆ\n\nüî• Made something that shouldn't exist? WE WANT IT\n‚ö° Browser games, web experiments, chaos engines\nüéØ Working URL = automatic acceptance\nüí´ Submission time: Under 60 seconds, guaranteed\n\nüëâ dumbassgames.xyz\n#GameDev #WebGames`,
                
                `üåü GAME DEVS: Your "trash" is our treasure! üíé\n\n‚ú® Prototype that got out of hand? Perfect\nüéÆ Game jam disaster? Even better\nüíÄ Something that barely works? IDEAL\n‚ö° URL ready? Submit in 60 seconds\n\nüöÄ Zero judgment zone: dumbassgames.xyz\n#IndieGames #GameDev`,
                
                `üö® DEV EMERGENCY: We need your weird games! üéÆ\n\nüí≠ That thing you made at 3am? UPLOAD IT\nüî• Broken physics engine? WE'LL TAKE IT\n‚ö° Accidentally good bad game? PERFECT\nüíÄ Cursed HTML5 experiment? YES PLEASE\n\nüöÄ dumbassgames.xyz\n#DevEmergency #CursedGames`,
                
                `üé™ WANTED: Creators of digital circus acts! üí´\n\nü§π Juggling game logic and prayer? That's our vibe\nüé® Art style: "I tried my best"? IDEAL\nüéµ Sound design: Random keyboard mashing? CHEF'S KISS\n‚ö° Submission requirement: One (1) working URL\n\nüåü dumbassgames.xyz\n#DigitalCircus #GameDev`,
                
                `üîä PSA FOR DEVS: Your rejected game jam entry belongs here! üéÆ\n\nüíî Too weird for itch.io? Perfect for us\nüå™Ô∏è Judges didn't "get it"? We will\nüíÄ Broke the theme spectacularly? AMAZING\n‚ö° Upload faster than your regret sets in\n\n‚ú® dumbassgames.xyz\n#GameJamRejects #VibeGames`,
                
                `üì° SIGNAL BOOST: Seeking creators of beautiful disasters! üíé\n\nüéÆ Tutorial you never finished? Upload the chaos\nüî• Feature that became the whole game? ICONIC\nüí´ Bug that's now a core mechanic? GENIUS\n‚ö° Working in browser? You're 100% qualified\n\nüöÄ dumbassgames.xyz\n#BeautifulDisasters #WebGames`
            ];
            
            const randomTweet = devCallouts[Math.floor(Math.random() * devCallouts.length)];
            window.lastGeneratedTweet = randomTweet;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
            window.open(twitterUrl, '_blank');
            
            output.innerHTML += `<div style="color: #00ff00;">‚úÖ Dev Callout opened in Twitter!</div>`;
            output.scrollTop = output.scrollHeight;
        }

        // Fun Fact Tweet
        async function generateFunFact() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üéØ Generating Fun Fact</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                const funFacts = [
                    `üéØ FUN FACT: DUMBASSGAMES has ${totalGames} games and exactly ZERO gatekeepers! üéÆ\n\n‚ú® Every game gets in if it has a URL\nüíÄ Quality control is just a suggestion\n‚ö° Submission time: Always under 60 seconds\nüî• Chaos level: Guaranteed maximum\n\nüëâ dumbassgames.xyz\n#FunFact`,
                    
                    `üí° DID YOU KNOW? We've archived ${totalGames} digital abominations! üíÄ\n\nüéÆ From cursed to blessed\n‚ú® From broken to beautiful\nüå™Ô∏è From chaos to... more chaos\n‚ö° All submitted in under 60 seconds\n\nüöÄ Add yours: dumbassgames.xyz\n#DidYouKnow #DigitalChaos`,
                    
                    `üåü WILD FACT: Our platform requires literally ONE thing - a working URL! üéØ\n\n‚ùå No approval process\n‚ùå No quality standards\n‚ùå No gatekeeping\n‚úÖ Just pure vibe coded chaos\n\nüéÆ ${totalGames} games and counting at dumbassgames.xyz\n#WildFact #VibeGames`,
                    
                    `üî• RANDOM FACT: Every game on DUMBASSGAMES was submitted by someone who said "this is probably dumb, but..." üéÆ\n\nüí´ Plot twist: We LOVE dumb\n‚ú® Dumb is our specialty\nüíÄ Dumb games = best games\n\nüëâ Submit your dumb game: dumbassgames.xyz\n#RandomFact #DumbGames`,
                    
                    `üß† BRAIN FACT: Our rejection rate is 0% and we're proud of it! üíÄ\n\nüéÆ ${totalGames} games submitted, ${totalGames} games accepted\n‚ú® Mathematical perfection: 100% chaos rate\n‚ö° Upload regret timeline: Instant\nüî• Fun guarantee: Unbreakable\n\nüöÄ dumbassgames.xyz\n#BrainFact #ZeroRejection`,
                    
                    `üíÄ SPOOKY FACT: We've never rejected a single game! üëª\n\nüéÆ Horror rate: 0% (we love everything)\n‚ú® Acceptance rate: Suspiciously high (100%)\n‚ö° Quality standards: What are those?\nüåü Your game's survival rate: Guaranteed\n\nüî• dumbassgames.xyz\n#SpookyFact #DigitalHorror`,
                    
                    `ü§Ø MIND-BLOWING FACT: Our longest submission took 37 seconds! ‚ö°\n\nüéÆ Average upload time: Under 30 seconds\nüíÄ Fastest submission: 8 seconds (new record!)\n‚ú® Slowest submission: Still faster than ordering pizza\nüî• Current collection: ${totalGames} speed-submitted disasters\n\nüöÄ dumbassgames.xyz\n#SpeedFact #FastChaos`,
                    
                    `üé≠ THEATER FACT: Every game here is a performance art piece! üé™\n\nüéÆ Intentional games: Some of them\nüíÄ Accidental masterpieces: Most of them\n‚ú® Games that transcend understanding: ${totalGames}\n‚ö° Art critics' opinion: We don't ask\n\nüåü dumbassgames.xyz\n#ArtFact #DigitalTheater`,
                    
                    `üß™ SCIENCE FACT: We're conducting the world's largest chaos experiment! üî¨\n\nüéÆ Test subjects: ${totalGames} digital specimens\nüíÄ Control group: Doesn't exist\n‚ú® Hypothesis: Chaos = Fun\n‚ö° Results: Hypothesis confirmed\n\nüî• dumbassgames.xyz\n#ScienceFact #ChaosExperiment`
                ];
                
                const randomTweet = funFacts[Math.floor(Math.random() * funFacts.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Fun Fact tweet opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">‚ùå Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Site Promotional Tweet
        async function generateSitePromo() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üöÄ Generating Site Promotional Tweet</div>`;
            
            try {
                // Get current game count for dynamic messaging
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                // Array of different promotional tweets to rotate through
                const promoTweets = [
                    // Main pitch tweet
                    `üéÆ DUMBASSGAMES: Where Digital Abominations Meet Glorious Failures! üíÄ\n\n‚ú® Discover vibe coded monstrosities\nüïπÔ∏è Play ${totalGames}+ chaotic retro games\n‚ö° Submit YOUR game in under 60 seconds\nüéØ No gatekeeping, just pure gaming chaos\n\nüîó dumbassgames.xyz\n#RetroGaming #IndieGames #VibeGames`,
                    
                    // Developer focused
                    `üì¢ CALLING ALL GAME DEVS! üéØ\n\nüéÆ Got a weird, broken, or brilliant game?\n‚è±Ô∏è Submit it to DUMBASSGAMES in <60 seconds\nüî• No approval process, no waiting\nüë• Instant community of chaos lovers\nüíé From cursed to blessed - we want it all!\n\nüöÄ dumbassgames.xyz\n#GameDev #IndieGames`,
                    
                    // Community focused  
                    `üèÜ ${totalGames}+ VIBE CODED GAMES & COUNTING! üéÆ\n\nüíÄ Digital abominations? ‚úÖ\nüåü Glorious failures? ‚úÖ  \nüéØ Peak dumbass content? ‚úÖ\n‚ö° 60-second game submissions? ‚úÖ\nüî• Sanity not guaranteed? ‚úÖ\n\nüïπÔ∏è Join the chaos at dumbassgames.xyz\n#RetroGaming #ChaosGaming`,
                    
                    // Nostalgia focused
                    `üïπÔ∏è REMEMBER WHEN GAMES WERE JUST... WEIRD? üéÆ\n\nüí´ DUMBASSGAMES brings back that energy:\nüéØ No corporate polish, just raw creativity\n‚ö° Submit your game in 60 seconds flat\nüî• ${totalGames}+ games of pure retro insanity\nüíÄ Sanity not guaranteed, fun definitely is!\n\nüöÄ dumbassgames.xyz\n#RetroGaming #IndieGames`,
                    
                    // Simple and direct
                    `üéÆ FREE RETRO GAME ARCADE ‚ö°\n\nüî• ${totalGames}+ vibe coded games\n‚è±Ô∏è Add YOUR game in <1 minute\nüíÄ Digital abominations welcome\nüéØ No gatekeeping, pure chaos\nüïπÔ∏è Browser-based, instant play\n\nüëâ dumbassgames.xyz\n#FreeGames #RetroGaming #BrowserGames`,
                    
                    // Chaos-focused
                    `üå™Ô∏è THE INTERNET'S MOST UNHINGED GAME COLLECTION! üíÄ\n\nüéÆ ${totalGames}+ games that probably shouldn't exist\nüí´ But we're glad they do anyway\n‚ö° Fastest submission process on the web\nüî• Zero quality control, maximum fun\n\n‚ú® dumbassgames.xyz\n#ChaosGaming #DigitalChaos`,
                    
                    // Anti-corporate
                    `üéØ TIRED OF CORPORATE GAMES? Try digital chaos instead! üéÆ\n\nüíÄ No polish, just passion\nüî• No committees, just creativity\n‚ö° No barriers, just browsers\nüåü No gatekeeping, just games\n\nüëâ ${totalGames}+ indie abominations at dumbassgames.xyz\n#IndieGames #AntiCorporate`,
                    
                    // Creator-focused
                    `üöÄ CREATORS: Your weird game has a home! üéÆ\n\n‚ú® Made something in 5 minutes? PERFECT\nüíÄ Accidentally created art? EVEN BETTER\n‚ö° Got a browser game? YOU'RE IN\nüî• Have zero budget? WHO CARES\n\nüåü dumbassgames.xyz - where creativity wins\n#CreateToday #IndieCreators`,
                    
                    // Discovery-focused
                    `üïπÔ∏è DISCOVER GAMES YOU'VE NEVER SEEN BEFORE! üéÆ\n\nüí´ No algorithm, just pure chaos\nüéØ ${totalGames}+ hidden gems & disasters\n‚ö° New submissions daily\nüíÄ From blessed to cursed, we have it all\n\nüî• Start exploring: dumbassgames.xyz\n#GameDiscovery #HiddenGems`
                ];
                
                // Pick a random promotional tweet
                const randomTweet = promoTweets[Math.floor(Math.random() * promoTweets.length)];
                
                window.lastGeneratedTweet = randomTweet;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Site Promotional Tweet opened in Twitter!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">üéØ Perfect for attracting new players and developers!</div>`;
                
            } catch (error) {
                // Fallback promotional tweet if Firebase fails
                const fallbackTweet = `üéÆ DUMBASSGAMES: The retro arcade for vibe coded monstrosities! üíÄ\n\n‚ö° Submit your game in 60 seconds\nüî• No gatekeeping, just pure chaos\nüïπÔ∏è Digital abominations & glorious failures welcome\n\nüöÄ dumbassgames.xyz\n#RetroGaming #IndieGames #VibeGames`;
                
                window.lastGeneratedTweet = fallbackTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(fallbackTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #ffff00;">‚ö†Ô∏è Using fallback promo tweet (Firebase error)</div>`;
                output.innerHTML += `<div style="color: #00ff00;">‚úÖ Promotional Tweet opened in Twitter!</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        function updateTwitterStatus() {
            try {
                // Check local Twitter integration first
                if (window.TwitterAPI) {
                    // Update Twitter Status
                    const twitterStatus = document.getElementById('twitterStatus');
                    twitterStatus.textContent = '‚úÖ CONNECTED';
                    twitterStatus.style.color = '#00ff00';
                    
                    // Update API Keys Status
                    const twitterKeys = document.getElementById('twitterKeys');
                    if (window.TwitterAPI.isConfigured) {
                        twitterKeys.textContent = '‚úÖ CONFIGURED';
                        twitterKeys.style.color = '#00ff00';
                    } else {
                        twitterKeys.textContent = '‚ùå MISSING';
                        twitterKeys.style.color = '#ff4444';
                    }
                    
                    // Update Automation Status
                    const automationStatus = document.getElementById('automationStatus');
                    if (window.TwitterAPI.isConfigured) {
                        automationStatus.textContent = '‚úÖ ENABLED';
                        automationStatus.style.color = '#00ff00';
                    } else {
                        automationStatus.textContent = '‚ùå DISABLED';
                        automationStatus.style.color = '#ff4444';
                    }
                    
                    // Update Last Tweet
                    const lastTweet = document.getElementById('lastTweet');
                    lastTweet.textContent = window.TwitterAPI.isConfigured ? 'Ready to Tweet' : 'Configure API Keys';
                    lastTweet.style.color = window.TwitterAPI.isConfigured ? '#00ff00' : '#ffff00';
                    
                } else {
                    // Fallback to main window check
                    const mainWindow = window.opener || window.parent;
                    
                    if (mainWindow && mainWindow.dumbassGameAdmin && mainWindow.siteMonitoring) {
                        // Update Twitter Status
                        const twitterStatus = document.getElementById('twitterStatus');
                        if (mainWindow.siteMonitoring) {
                            twitterStatus.textContent = '‚úÖ CONNECTED';
                            twitterStatus.style.color = '#00ff00';
                        } else {
                            twitterStatus.textContent = '‚ùå DISCONNECTED';
                            twitterStatus.style.color = '#ff4444';
                        }
                        
                        // Update API Keys Status
                        const twitterKeys = document.getElementById('twitterKeys');
                        if (mainWindow.TwitterAPI && mainWindow.TwitterAPI.isConfigured) {
                            twitterKeys.textContent = '‚úÖ CONFIGURED';
                            twitterKeys.style.color = '#00ff00';
                        } else {
                            twitterKeys.textContent = '‚ùå MISSING';
                            twitterKeys.style.color = '#ff4444';
                        }
                        
                        // Update Automation Status
                        const automationStatus = document.getElementById('automationStatus');
                        const status = mainWindow.siteMonitoring.getAutomationStatus();
                        if (status && status.twitter) {
                            automationStatus.textContent = '‚úÖ ENABLED';
                            automationStatus.style.color = '#00ff00';
                        } else {
                            automationStatus.textContent = '‚ùå DISABLED';
                            automationStatus.style.color = '#ff4444';
                        }
                        
                        // Update Last Tweet
                        const lastTweet = document.getElementById('lastTweet');
                        lastTweet.textContent = 'Simulation Mode';
                        lastTweet.style.color = '#ffff00';
                        
                    } else {
                        // Not connected to main site and no local Twitter
                        ['twitterStatus', 'twitterKeys', 'automationStatus'].forEach(id => {
                            const element = document.getElementById(id);
                            element.textContent = '‚è≥ LOADING...';
                            element.style.color = '#ffff00';
                        });
                        
                        const lastTweet = document.getElementById('lastTweet');
                        lastTweet.textContent = 'Loading...';
                        lastTweet.style.color = '#888';
                    }
                }
            } catch (error) {
                console.warn('Error updating Twitter status:', error);
            }
        }

        // Set up character counter for tweet input
        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('customTweetInput');
            if (input) {
                input.addEventListener('input', updateCharCount);
                
                // Allow Enter key to send tweet
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendCustomTweet();
                    }
                });
            }
            
            // Initial Twitter status update
            setTimeout(updateTwitterStatus, 2000);
            
            // Update Twitter status every 10 seconds
            setInterval(updateTwitterStatus, 10000);
        });
        
        // Initial update after page loads
        setTimeout(updateDashboardStats, 2000);
        
        // Welcome message
        setTimeout(() => {
            consoleDiv.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">üéÆ DUMBASSGAMES Admin Dashboard Ready!</div>`;
            consoleDiv.innerHTML += `<div style="color: #888;">Loading admin systems...</div>`;
            
            // Check if admin system is ready
            const checkAdminReady = () => {
                if (window.dumbassGameAdmin) {
                    consoleDiv.innerHTML += `<div style="color: #00ff00;">‚úÖ Admin system loaded! Commands are now available.</div>`;
                    updateDashboardStats();
                } else {
                    consoleDiv.innerHTML += `<div style="color: #ffff00;">‚è≥ Still loading... Please wait...</div>`;
                    setTimeout(checkAdminReady, 2000);
                }
            };
            
            setTimeout(checkAdminReady, 3000);
        }, 1000);
    </script>
    
    <!-- Twitter Integration Script -->
    <script src="twitter-integration.js"></script>
</body>
</html> 