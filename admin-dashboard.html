<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ DUMBASSGAMES Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P:wght@400&display=swap" rel="stylesheet">
    <style>
        /* Retro Admin Dashboard Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #0a0a0a, #1a1a2e, #16213e);
            color: #00ff00;
            min-height: 100vh;
            overflow-x: auto;
            position: relative;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, transparent 98%, rgba(0, 255, 0, 0.03) 100%),
                linear-gradient(180deg, transparent 98%, rgba(0, 255, 255, 0.03) 100%);
            background-size: 25px 25px;
            animation: grid 20s linear infinite;
            z-index: -1;
        }

        @keyframes grid {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 25px 25px, 25px 25px; }
        }

        .admin-header {
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #00ff00;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .admin-title {
            font-family: 'Press Start 2P', monospace;
            font-size: 24px;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff;
            margin-bottom: 10px;
        }

        .admin-subtitle {
            color: #888;
            font-size: 14px;
        }

        .dashboard-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .stats-panel {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }

        .panel-title {
            font-family: 'Press Start 2P', monospace;
            font-size: 16px;
            color: #00ffff;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 10px #00ffff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 20, 0, 0.8);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            background: rgba(0, 30, 0, 0.9);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
            transform: translateY(-2px);
        }

        .stat-label {
            font-size: 12px;
            color: #888;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00;
        }

        .commands-panel {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .commands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .admin-btn {
            background: linear-gradient(45deg, #001100, #003300);
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 12px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .admin-btn:hover {
            background: linear-gradient(45deg, #002200, #004400);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
            transform: translateY(-1px);
        }

        .admin-btn:active {
            transform: translateY(1px);
        }

        .console-output {
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        .console-output::-webkit-scrollbar {
            width: 8px;
        }

        .console-output::-webkit-scrollbar-track {
            background: #111;
        }

        .console-output::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }

        .loading-indicator {
            display: inline-block;
            color: #ffff00;
        }

        .loading-indicator::after {
            content: '...';
            animation: dots 1s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            
            .admin-title {
                font-size: 18px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .commands-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .error-text { color: #ff4444; }
        .success-text { color: #00ff00; }
        .warning-text { color: #ffff00; }
        .info-text { color: #00ffff; }
    </style>

</head>
<body>
    <div class="admin-header">
        <div class="admin-title">ğŸ‘‘ ADMIN CONSOLE</div>
        <div class="admin-subtitle">DUMBASSGAMES Site Management Dashboard</div>
    </div>

    <div class="dashboard-container">
        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="panel-title">ğŸ“Š SITE STATISTICS</div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Site Status</div>
                    <div class="stat-value" id="siteStatus">â³ LOADING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Games</div>
                    <div class="stat-value" id="totalGames">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Users Online</div>
                    <div class="stat-value" id="usersOnline">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Top Search</div>
                    <div class="stat-value" id="topSearch">-</div>
                </div>
            </div>
        </div>

        <!-- Commands Panel -->
        <div class="commands-panel">
            <div class="panel-title">âš¡ ADMIN COMMANDS</div>
            <div class="commands-grid">
                <button class="admin-btn" onclick="runCommand('dailyReport')">ğŸ“Š Daily Report</button>
                <button class="admin-btn" onclick="runCommand('siteHealth')">ğŸ¥ Site Health</button>
                <button class="admin-btn" onclick="runCommand('liveStats')">ğŸ“ˆ Live Stats</button>
                <button class="admin-btn" onclick="runCommand('getFirebaseStats')">ğŸ”¥ Firebase Stats</button>
                <button class="admin-btn" onclick="runCommand('debugFirebase')">ğŸ” Debug DB</button>
                <button class="admin-btn" onclick="runCommand('listGames')">ğŸ® List Games</button>
                <button class="admin-btn" onclick="runCommand('cleanupDuplicates')">ğŸ§¹ Check Dupes</button>
                <button class="admin-btn" onclick="runCommand('recentSignups')">ğŸ“§ Signups</button>
                <button class="admin-btn" onclick="runCommand('recentErrors')">ğŸš¨ Errors</button>
                <button class="admin-btn" onclick="runCommand('viewBugReports')">ğŸ› Bug Reports</button>
            </div>
            
            <div class="panel-title" style="margin-top: 20px;">ğŸ‘‘ ADMIN CONSOLE OUTPUT</div>
            <div class="console-output" id="consoleOutput">
                Commands will appear here...
            </div>
        </div>
    </div>

    <!-- Twitter Automation Panel -->
    <div style="max-width: 1400px; margin: 0 auto; padding: 0 20px 20px;">
        <div class="stats-panel">
            <div class="panel-title">ğŸ¦ TWITTER AUTOMATION</div>
            
            <!-- Twitter Status -->
            <div class="stats-grid" style="margin-bottom: 20px;">
                <div class="stat-card">
                    <div class="stat-label">Twitter Status</div>
                    <div class="stat-value" id="twitterStatus">â³ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">API Keys</div>
                    <div class="stat-value" id="twitterKeys">â³ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Automation</div>
                    <div class="stat-value" id="automationStatus">â³ CHECKING</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Last Tweet</div>
                    <div class="stat-value" id="lastTweet">-</div>
                </div>
            </div>

            <!-- Twitter Controls -->
            <div class="commands-grid">
                <button class="admin-btn" onclick="runTwitterCommand('systemCheck')" style="border-color: #00ffff;">ğŸ” System Check</button>
                <button class="admin-btn" onclick="runTwitterCommand('getAutomationStatus')" style="border-color: #00ffff;">ğŸ“Š Automation Status</button>
                <button class="admin-btn" onclick="runTwitterCommand('generateDailyTweet')" style="border-color: #00ffff;">ğŸ“ Daily Stats</button>
                <button class="admin-btn" onclick="postDailyTweet()" style="border-color: #00ff00;">ğŸ“¤ Post Daily Tweet</button>
                <button class="admin-btn" onclick="generateNewGameTweet()" style="border-color: #00ff00;">ğŸ® New Game Alert</button>
                <button class="admin-btn" onclick="generateGameSpotlight()" style="border-color: #ffff00;">â­ Game Spotlight</button>
                <button class="admin-btn" onclick="generateWeeklyStats()" style="border-color: #00ffff;">ğŸ“… Weekly Summary</button>
                <button class="admin-btn" onclick="generateRandomRecommendation()" style="border-color: #ff00ff;">ğŸ² Random Pick</button>
                <button class="admin-btn" onclick="generateMilestone()" style="border-color: #00ff00;">ğŸ† Milestone</button>
                <button class="admin-btn" onclick="generateSitePromo()" style="border-color: #ff00ff;">ğŸš€ Site Promo</button>
                <button class="admin-btn" onclick="generateVibeCheck()" style="border-color: #ff6b35;">âœ¨ Vibe Check</button>
                <button class="admin-btn" onclick="generateChaosUpdate()" style="border-color: #8b00ff;">ğŸŒªï¸ Chaos Update</button>
                <button class="admin-btn" onclick="generateDevCallout()" style="border-color: #00ff80;">ğŸ“¢ Dev Callout</button>
                <button class="admin-btn" onclick="generateFunFact()" style="border-color: #ff1493;">ğŸ¯ Fun Fact</button>
                <button class="admin-btn" onclick="runTwitterCommand('enableTwitter')" style="border-color: #00ff00;">âœ… Enable Twitter</button>
                <button class="admin-btn" onclick="runTwitterCommand('disableTwitter')" style="border-color: #ff4444;">âŒ Disable Twitter</button>
                <button class="admin-btn" onclick="runTwitterCommand('testTwitter')" style="border-color: #ffff00;">ğŸ§ª Test Connection</button>
            </div>

            <!-- Custom Tweet Input -->
            <div style="margin-top: 20px;">
                <div class="stat-label" style="margin-bottom: 10px;">ğŸ“ Send Custom Tweet</div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="customTweetInput" placeholder="Enter your tweet message..." 
                           style="flex: 1; background: rgba(0,0,0,0.8); border: 1px solid #00ff00; color: #00ff00; 
                                  padding: 10px; border-radius: 5px; font-family: 'Courier New', monospace;"
                           maxlength="280">
                    <button class="admin-btn" onclick="sendCustomTweet()" style="border-color: #00ffff; min-width: 100px;">
                        ğŸ¦ TWEET
                    </button>
                </div>
                <div style="font-size: 11px; color: #888; margin-top: 5px;">
                    Character count: <span id="charCount">0</span>/280
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK v11.0.2 (Updated to match main site) -->
    <script type="module">
        // Firebase configuration (same as main site)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js';
        import { getFirestore, collection, getDocs, query, where, orderBy, limit, addDoc } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCuaKGPn6_wVD9p56U2MNHuyVBI-CN3o70",
            authDomain: "dumbassgames-c1217.firebaseapp.com",
            projectId: "dumbassgames-c1217",
            storageBucket: "dumbassgames-c1217.firebasestorage.app",
            messagingSenderId: "949393088299",
            appId: "1:949393088299:web:fdd3f0d2f91d7efb7f2a80"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        // Set up the same collection reference as main site
        const firebaseCollection = collection(db, 'games');
        
        // Make Firebase functions available globally (like main site)
        window.firebaseGetDocs = getDocs;
        window.firebaseQuery = query;
        window.firebaseWhere = where;
        window.firebaseOrderBy = orderBy;
        window.firebaseLimit = limit;
        window.firebaseAddDoc = addDoc;
        window.firebaseCollection = (db, collectionName) => collection(db, collectionName);
        window.firebaseDb = db;
        window.db = db;
        window.auth = auth;

        // Check if user is authorized admin
        function isUserAdmin() {
            const currentUser = auth?.currentUser;
            if (!currentUser) return false;
            
            // Debug: Log current user info
            console.log('ğŸ” Dashboard - Current user UID:', currentUser.uid);
            console.log('ğŸ” Dashboard - Current user email:', currentUser.email);
            
            // Admin UIDs - must match main site
            const adminUIDs = [
                'FIMoIezOXMRmkg9bl3ArJGCkuf93', // dumbassgames@proton.me
                // Add other admin UIDs here if needed
            ];
            
            const isAdmin = adminUIDs.includes(currentUser.uid);
            console.log('ğŸ” Dashboard - Is user admin?', isAdmin);
            return isAdmin;
        }

        // Protect admin dashboard access
        async function checkAdminAccess() {
            try {
                console.log('ğŸ” Starting admin access check...');
                
                // Wait longer for auth to initialize and retry multiple times
                let authUser = null;
                let attempts = 0;
                const maxAttempts = 10;
                
                while (!authUser && attempts < maxAttempts) {
                    attempts++;
                    console.log(`ğŸ” Auth check attempt ${attempts}/${maxAttempts}`);
                    
                    authUser = auth.currentUser;
                    
                    if (!authUser) {
                        // Wait for auth state change
                        await new Promise((resolve) => {
                            const unsubscribe = onAuthStateChanged(auth, (user) => {
                                authUser = user;
                                unsubscribe();
                                resolve();
                            });
                            
                            // Also resolve after timeout
                            setTimeout(resolve, 1000);
                        });
                    }
                    
                    if (!authUser) {
                        await new Promise(resolve => setTimeout(resolve, 500));
                    }
                }
                
                console.log('ğŸ” Final auth user:', authUser?.email || 'none');
                
                if (!authUser) {
                    console.warn('ğŸš« No authenticated user found after retries');
                    document.body.innerHTML = `
                        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ffff00; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                            <h1>â³ AUTHENTICATION LOADING</h1>
                            <p style="margin: 20px 0; color: #00ffff;">Please wait while we verify your credentials...</p>
                            <button onclick="location.reload()" style="background: #00ffff; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">RETRY</button>
                        </div>
                    `;
                    return false;
                }

                if (!isUserAdmin()) {
                    console.warn('ğŸš« User is authenticated but not admin:', authUser.email);
                    document.body.innerHTML = `
                        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ff4444; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                            <h1>ğŸš« ACCESS DENIED</h1>
                            <p style="margin: 20px 0; color: #00ffff;">Admin privileges required</p>
                            <p style="margin: 10px 0; color: #666; font-size: 8px;">Signed in as: ${authUser.email}</p>
                            <button onclick="window.close()" style="background: #ff4444; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">CLOSE</button>
                        </div>
                    `;
                    return false;
                }
                
                console.log('âœ… Admin access granted for:', authUser.email);
                return true;
            } catch (error) {
                console.error('Auth check failed:', error);
                document.body.innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #ff4444; font-family: 'Press Start 2P', cursive; text-align: center; flex-direction: column;">
                        <h1>âŒ ERROR</h1>
                        <p style="margin: 20px 0; color: #00ffff;">Authentication system error</p>
                        <button onclick="location.reload()" style="background: #ff4444; color: #000; border: none; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 8px; cursor: pointer;">RETRY</button>
                    </div>
                `;
                return false;
            }
        }

        // Lightweight Admin System
        class DashboardAdmin {
            constructor() {
                this.isReady = false;
                this.initialize();
            }

            async initialize() {
                try {
                    // Check admin access first
                    const hasAccess = await checkAdminAccess();
                    if (!hasAccess) {
                        return;
                    }

                    // Test Firebase connection using same method as main site
                    await getDocs(query(firebaseCollection, limit(1)));
                    this.isReady = true;
                    console.log('ğŸ”¥ Dashboard admin system ready!');
                } catch (error) {
                    console.error('âŒ Firebase connection failed:', error);
                }
            }

            async dailyReport() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const totalGames = gamesSnapshot.size;
                    
                    const report = {
                        date: new Date().toLocaleDateString(),
                        totalGames: totalGames,
                        status: 'Online',
                        lastUpdated: new Date().toLocaleTimeString()
                    };
                    
                    console.group('ğŸ“Š DAILY REPORT');
                    console.log('Date:', report.date);
                    console.log('Total Games:', report.totalGames);
                    console.log('Status:', report.status);
                    console.log('Last Updated:', report.lastUpdated);
                    console.groupEnd();
                    
                    return `Daily Report Generated - ${totalGames} games in database`;
                } catch (error) {
                    return `Error generating report: ${error.message}`;
                }
            }

            async getFirebaseStats() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => doc.data());
                    
                    const stats = {
                        totalGames: games.length,
                        categories: {},
                        recentGames: games.filter(g => {
                            const gameDate = new Date(g.submittedAt || '2024-01-01');
                            const weekAgo = new Date();
                            weekAgo.setDate(weekAgo.getDate() - 7);
                            return gameDate > weekAgo;
                        }).length
                    };
                    
                    // Count categories
                    games.forEach(game => {
                        const category = game.category || 'unknown';
                        stats.categories[category] = (stats.categories[category] || 0) + 1;
                    });
                    
                    console.group('ğŸ”¥ FIREBASE STATISTICS');
                    console.log('Total Games:', stats.totalGames);
                    console.log('Recent Games (7 days):', stats.recentGames);
                    console.log('Categories:', stats.categories);
                    console.groupEnd();
                    
                    return `Firebase Stats: ${stats.totalGames} total games, ${stats.recentGames} recent`;
                } catch (error) {
                    return `Error fetching stats: ${error.message}`;
                }
            }

            siteHealth() {
                const health = {
                    firebase: this.isReady ? 'âœ… Connected' : 'âŒ Disconnected',
                    browser: navigator.onLine ? 'âœ… Online' : 'âŒ Offline',
                    timestamp: new Date().toLocaleTimeString(),
                    userAgent: navigator.userAgent.slice(0, 50) + '...'
                };
                
                console.group('ğŸ¥ SITE HEALTH CHECK');
                console.log('Firebase:', health.firebase);
                console.log('Browser:', health.browser);
                console.log('Timestamp:', health.timestamp);
                console.log('User Agent:', health.userAgent);
                console.groupEnd();
                
                return `Site Health: Firebase ${this.isReady ? 'OK' : 'ERROR'}, Browser ${navigator.onLine ? 'OK' : 'OFFLINE'}`;
            }

            liveStats() {
                const stats = {
                    pageLoadTime: Math.round(performance.now()),
                    memoryUsage: performance.memory ? Math.round(performance.memory.usedJSHeapSize / 1024 / 1024) : 'Unknown',
                    networkStatus: navigator.onLine ? 'Online' : 'Offline',
                    timestamp: new Date().toLocaleString()
                };
                
                console.group('ğŸ“ˆ LIVE STATISTICS');
                console.log('Page Load Time:', stats.pageLoadTime + 'ms');
                console.log('Memory Usage:', stats.memoryUsage + 'MB');
                console.log('Network:', stats.networkStatus);
                console.log('Timestamp:', stats.timestamp);
                console.groupEnd();
                
                return `Live Stats: ${stats.pageLoadTime}ms load time, ${stats.memoryUsage}MB memory`;
            }

            async listGames() {
                try {
                    const gamesSnapshot = await getDocs(query(firebaseCollection, limit(10)));
                    const games = gamesSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    console.group('ğŸ® RECENT GAMES (Last 10)');
                    games.forEach(game => {
                        console.log(`${game.title} - ${game.url}`);
                    });
                    console.groupEnd();
                    
                    return `Listed ${games.length} recent games`;
                } catch (error) {
                    return `Error listing games: ${error.message}`;
                }
            }

            async recentSignups() {
                try {
                    console.log('ğŸ“§ Fetching recent signups...');
                    
                    // Get users from Firebase Auth (if available) or admin_events collection
                    const usersCollection = window.firebaseCollection(window.firebaseDb, 'admin_events');
                    const signupQuery = window.firebaseQuery(
                        usersCollection,
                        window.firebaseWhere('type', '==', 'signup'),
                        window.firebaseOrderBy('timestamp', 'desc'),
                        window.firebaseLimit(10)
                    );
                    
                    const signupSnapshot = await window.firebaseGetDocs(signupQuery);
                    const signups = signupSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    if (signups.length === 0) {
                        // Try to get user profiles instead
                        const profilesCollection = window.firebaseCollection(window.firebaseDb, 'users');
                        const profileQuery = window.firebaseQuery(
                            profilesCollection,
                            window.firebaseOrderBy('joinDate', 'desc'),
                            window.firebaseLimit(5)
                        );
                        
                        const profileSnapshot = await window.firebaseGetDocs(profileQuery);
                        const profiles = profileSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        
                        console.group('ğŸ‘¥ RECENT USER PROFILES');
                        profiles.forEach((profile, index) => {
                            const joinDate = new Date(profile.joinDate).toLocaleString();
                            console.log(`${index + 1}. ${profile.email || profile.displayName || 'Unknown'} - Joined: ${joinDate}`);
                        });
                        console.groupEnd();
                        
                        // Also add to dashboard output
                        const output = document.getElementById('consoleOutput');
                        if (output) {
                            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ‘¥ RECENT USER PROFILES:</div>`;
                            profiles.forEach((profile, index) => {
                                const joinDate = new Date(profile.joinDate).toLocaleString();
                                const displayName = profile.email || profile.displayName || 'Unknown';
                                output.innerHTML += `<div style="color: #888;">${index + 1}. ${displayName} - Joined: ${joinDate}</div>`;
                            });
                            output.scrollTop = output.scrollHeight;
                        }
                        
                        return `Found ${profiles.length} recent user profiles`;
                    }
                    
                    console.group('ğŸ“§ RECENT SIGNUPS');
                    signups.forEach((signup, index) => {
                        const signupTime = new Date(signup.timestamp).toLocaleString();
                        console.log(`${index + 1}. ${signup.data?.email || signup.email || 'Unknown'} - ${signupTime}`);
                        if (signup.data?.referrer) {
                            console.log(`   ğŸ“ Referrer: ${signup.data.referrer}`);
                        }
                    });
                    console.groupEnd();
                    
                    // Also add to dashboard output
                    const output = document.getElementById('consoleOutput');
                    if (output) {
                        output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ“§ RECENT SIGNUPS:</div>`;
                        signups.forEach((signup, index) => {
                            const signupTime = new Date(signup.timestamp).toLocaleString();
                            const email = signup.data?.email || signup.email || 'Unknown';
                            output.innerHTML += `<div style="color: #888;">${index + 1}. ${email} - ${signupTime}</div>`;
                            if (signup.data?.referrer) {
                                output.innerHTML += `<div style="color: #666;">   ğŸ“ Referrer: ${signup.data.referrer}</div>`;
                            }
                        });
                        output.scrollTop = output.scrollHeight;
                    }
                    
                    return `Found ${signups.length} recent signups`;
                } catch (error) {
                    console.warn('Error fetching signups:', error);
                    return `Error fetching signups: ${error.message}`;
                }
            }

            async recentErrors() {
                try {
                    console.log('ğŸš¨ Fetching recent errors...');
                    
                    // Get errors from admin_events collection
                    const eventsCollection = window.firebaseCollection(window.firebaseDb, 'admin_events');
                    const errorQuery = window.firebaseQuery(
                        eventsCollection,
                        window.firebaseWhere('type', '==', 'error'),
                        window.firebaseOrderBy('timestamp', 'desc'),
                        window.firebaseLimit(10)
                    );
                    
                    const errorSnapshot = await window.firebaseGetDocs(errorQuery);
                    const errors = errorSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    if (errors.length === 0) {
                        console.log('âœ… No recent errors found - site is running smoothly!');
                        
                        // Also add to dashboard output
                        const output = document.getElementById('consoleOutput');
                        if (output) {
                            output.innerHTML += `<div style="color: #00ff00; margin-top: 10px;">âœ… No recent errors found - site is healthy!</div>`;
                            output.scrollTop = output.scrollHeight;
                        }
                        
                        return 'No recent errors found - site is healthy! âœ…';
                    }
                    
                    console.group('ğŸš¨ RECENT ERRORS');
                    errors.forEach((error, index) => {
                        const errorTime = new Date(error.timestamp).toLocaleString();
                        console.log(`${index + 1}. ${error.data?.message || error.message || 'Unknown error'} - ${errorTime}`);
                        if (error.data?.stack) {
                            console.log(`   ğŸ“ Stack: ${error.data.stack.substring(0, 100)}...`);
                        }
                        if (error.data?.userAgent) {
                            console.log(`   ğŸ–¥ï¸ Browser: ${error.data.userAgent.substring(0, 50)}...`);
                        }
                    });
                    console.groupEnd();
                    
                    // Also add to dashboard output
                    const output = document.getElementById('consoleOutput');
                    if (output) {
                        output.innerHTML += `<div style="color: #ff4444; margin-top: 10px;">ğŸš¨ RECENT ERRORS:</div>`;
                        errors.forEach((error, index) => {
                            const errorTime = new Date(error.timestamp).toLocaleString();
                            const message = error.data?.message || error.message || 'Unknown error';
                            output.innerHTML += `<div style="color: #888;">${index + 1}. ${message} - ${errorTime}</div>`;
                            if (error.data?.stack) {
                                output.innerHTML += `<div style="color: #666;">   ğŸ“ Stack: ${error.data.stack.substring(0, 100)}...</div>`;
                            }
                            if (error.data?.userAgent) {
                                output.innerHTML += `<div style="color: #666;">   ğŸ–¥ï¸ Browser: ${error.data.userAgent.substring(0, 50)}...</div>`;
                            }
                        });
                        output.scrollTop = output.scrollHeight;
                    }
                    
                    return `Found ${errors.length} recent errors`;
                } catch (error) {
                    console.warn('Error fetching errors:', error);
                    return `Error fetching error logs: ${error.message}`;
                }
            }

            searchAnalytics() {
                console.log('ğŸ” Search analytics are available on the main site');
                return 'Search analytics require the main site to be running';
            }

            async cleanupDuplicates() {
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    
                    const titleMap = {};
                    let duplicates = 0;
                    
                    games.forEach(game => {
                        const title = game.title?.toLowerCase().trim();
                        if (title) {
                            if (titleMap[title]) {
                                duplicates++;
                            } else {
                                titleMap[title] = game;
                            }
                        }
                    });
                    
                    return `Found ${duplicates} potential duplicates (use main site for actual cleanup)`;
                } catch (error) {
                    return `Error checking duplicates: ${error.message}`;
                }
            }

            async debugFirebase() {
                try {
                    console.group('ğŸ” FIREBASE DEBUG');
                    
                    // Show Firebase project info
                    console.log('ğŸ—ï¸ Firebase Project ID:', window.db.app.options.projectId);
                    console.log('ğŸ—ï¸ Firebase Auth Domain:', window.db.app.options.authDomain);
                    console.log('ğŸ—ï¸ Full Config:', window.db.app.options);
                    
                    // Check basic connection
                    console.log('ğŸ“¡ Testing Firebase connection...');
                    const testSnapshot = await getDocs(query(firebaseCollection, limit(1)));
                    console.log('âœ… Firebase connection successful');
                    
                    // Get all collections to see what exists
                    console.log('ğŸ“‹ Checking games collection...');
                    const allGamesSnapshot = await getDocs(firebaseCollection);
                    console.log(`ğŸ“Š Total documents in 'games' collection: ${allGamesSnapshot.size}`);
                    
                    // Log first few games
                    if (allGamesSnapshot.size > 0) {
                        console.log('ğŸ® Sample games:');
                        allGamesSnapshot.docs.slice(0, 3).forEach((doc, i) => {
                            const data = doc.data();
                            console.log(`${i + 1}. ${data.title || 'No title'} - ${data.url || 'No URL'}`);
                        });
                    } else {
                        console.log('âŒ No documents found in games collection');
                        
                        // Check if games might be in localStorage instead
                        const localStorageGames = localStorage.getItem('dumbassGames') || localStorage.getItem('games');
                        if (localStorageGames) {
                            const parsedGames = JSON.parse(localStorageGames);
                            console.log(`ğŸ’¾ Found ${parsedGames.length || 0} games in localStorage`);
                            console.log('ğŸ“‹ Local games:', parsedGames.slice(0, 3).map(g => g.title || 'No title'));
                        } else {
                            console.log('ğŸ’¾ No games found in localStorage either');
                        }
                    }
                    
                    console.groupEnd();
                    
                    return `Debug complete - ${allGamesSnapshot.size} games in Firebase, check console for details`;
                } catch (error) {
                    console.error('âŒ Firebase debug error:', error);
                    return `Debug failed: ${error.message}`;
                }
            }

            async viewBugReports(output) {
                console.log('ğŸ“‹ Viewing bug reports...');
                try {
                    const gamesSnapshot = await getDocs(firebaseCollection);
                    const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    console.group('ğŸ› BUG REPORTS');
                    games.forEach(game => {
                        console.log(`${game.title} - ${game.description || 'No description'}`);
                    });
                    console.groupEnd();
                    
                    return `Viewed ${games.length} bug reports`;
                } catch (error) {
                    return `Error viewing bug reports: ${error.message}`;
                }
            }
        }

        // Create dashboard admin instance
        window.dumbassGameAdmin = new DashboardAdmin();
        
        // Wait for initialization
        const waitForInit = async () => {
            if (window.dumbassGameAdmin.isReady) {
                console.log('âœ… Dashboard admin system ready!');
                if (window.updateDashboardStats) {
                    await window.updateDashboardStats();
                }
            } else {
                setTimeout(waitForInit, 1000);
            }
        };
        
        setTimeout(waitForInit, 1000);
    </script>

    <script>
        let consoleDiv = document.getElementById('consoleOutput');
        
        function runCommand(commandName) {
            const output = document.getElementById('consoleOutput');
            
            // Add command to output
            output.innerHTML += `<div style="color: #ffff00; margin-top: 10px;">â†’ ${commandName}()</div>`;
            
            try {
                let result;
                
                // Wait for admin system to be ready
                if (!window.dumbassGameAdmin) {
                    output.innerHTML += `<div style="color: #ffff00;">â³ Initializing admin system...</div>`;
                    
                    // Wait a bit for scripts to load
                    setTimeout(() => {
                        runCommand(commandName);
                    }, 2000);
                    return;
                }
                
                // Handle bug reports command
                if (commandName === 'viewBugReports') {
                    handleViewBugReports(output);
                    return;
                }
                
                if (window.dumbassGameAdmin && window.dumbassGameAdmin[commandName]) {
                    // Special handling for async commands
                    if (commandName === 'recentSignups' || commandName === 'recentErrors') {
                        // Show loading indicator
                        output.innerHTML += `<div style="color: #ffff00;">â³ Loading ${commandName === 'recentSignups' ? 'signups' : 'errors'}...</div>`;
                        
                        // Call async function
                        window.dumbassGameAdmin[commandName]().then(res => {
                            output.innerHTML += `<div style="color: #00ff00;">âœ… ${res}</div>`;
                            output.scrollTop = output.scrollHeight;
                        }).catch(err => {
                            output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${err}</div>`;
                            output.scrollTop = output.scrollHeight;
                        });
                        return; // Exit early for async commands
                    } else {
                        result = window.dumbassGameAdmin[commandName]();
                    }
                } else {
                    result = `âŒ Command "${commandName}" not found in admin system`;
                }
                
                if (result && result.then) {
                    // Handle promises
                    result.then(res => {
                        output.innerHTML += `<div style="color: #00ff00;">âœ… ${res}</div>`;
                        output.scrollTop = output.scrollHeight;
                    }).catch(err => {
                        output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${err}</div>`;
                        output.scrollTop = output.scrollHeight;
                    });
                } else {
                    output.innerHTML += `<div style="color: #00ff00;">âœ… ${result}</div>`;
                }
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            
            // Scroll to bottom
            output.scrollTop = output.scrollHeight;
        }
        
        async function handleViewBugReports(output) {
            output.innerHTML += `<div style="color: #00ffff;">ğŸ› Loading bug reports from Firebase...</div>`;
            
            try {
                if (!window.firebaseDb || !window.firebaseCollection) {
                    throw new Error('Firebase not available');
                }
                
                // Get bugs collection
                const bugsCollection = window.firebaseCollection(window.firebaseDb, 'bugs');
                const bugsSnapshot = await window.firebaseGetDocs(bugsCollection);
                
                if (bugsSnapshot.empty) {
                    output.innerHTML += `<div style="color: #ffff00;">ğŸ“‹ No bug reports found</div>`;
                    output.innerHTML += `<div style="color: #888;">Users can submit bug reports via the footer button</div>`;
                    return;
                }
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Found ${bugsSnapshot.size} bug reports:</div>`;
                output.innerHTML += `<div style="color: #00ffff;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>`;
                
                let reportCount = 0;
                bugsSnapshot.forEach((doc) => {
                    const bug = doc.data();
                    reportCount++;
                    
                    // Format timestamp
                    const timestamp = bug.timestamp ? new Date(bug.timestamp).toLocaleString() : 'Unknown';
                    
                    // Get severity color
                    let severityColor = '#ffff00';
                    if (bug.severity === 'low') severityColor = '#00ff00';
                    else if (bug.severity === 'high') severityColor = '#ff8800';
                    else if (bug.severity === 'critical') severityColor = '#ff4444';
                    
                    output.innerHTML += `<div style="color: #00ff00; margin-top: 15px;">ğŸ› Report #${reportCount} - ${bug.id || doc.id}</div>`;
                    output.innerHTML += `<div style="color: #ffff00;">ğŸ“… ${timestamp}</div>`;
                    output.innerHTML += `<div style="color: #ffffff;"><strong>Title:</strong> ${bug.title || 'No title'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>Category:</strong> ${bug.category || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: ${severityColor};"><strong>Severity:</strong> ${bug.severity || 'medium'}</div>`;
                    output.innerHTML += `<div style="color: #cccccc;"><strong>Description:</strong> ${bug.description || 'No description'}</div>`;
                    
                    if (bug.steps) {
                        output.innerHTML += `<div style="color: #aaaaaa;"><strong>Steps:</strong> ${bug.steps}</div>`;
                    }
                    
                    output.innerHTML += `<div style="color: #888;"><strong>Browser:</strong> ${bug.browser || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>Device:</strong> ${bug.device || 'Unknown'}</div>`;
                    output.innerHTML += `<div style="color: #888;"><strong>User:</strong> ${bug.userEmail || 'Anonymous'}</div>`;
                    
                    if (bug.contact) {
                        output.innerHTML += `<div style="color: #00ffff;"><strong>Contact:</strong> ${bug.contact}</div>`;
                    }
                    
                    output.innerHTML += `<div style="color: #666;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</div>`;
                });
                
                output.innerHTML += `<div style="color: #00ff00; margin-top: 10px;">âœ… Displayed ${reportCount} bug reports</div>`;
                output.innerHTML += `<div style="color: #00ffff;">ğŸ’¡ Tip: Use browser dev tools to copy bug details</div>`;
                
            } catch (error) {
                console.error('âŒ Error loading bug reports:', error);
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error loading bug reports: ${error.message}</div>`;
                output.innerHTML += `<div style="color: #ffff00;">ğŸ”§ Make sure Firebase is connected and user is authenticated</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }
        
        async function updateDashboardStats() {
            try {
                // Update site status
                const siteStatus = document.getElementById('siteStatus');
                if (navigator.onLine && window.dumbassGameAdmin?.isReady) {
                    siteStatus.textContent = 'âœ… ONLINE';
                    siteStatus.style.color = '#00ff00';
                } else {
                    siteStatus.textContent = 'â³ LOADING';
                    siteStatus.style.color = '#ffff00';
                }
                
                // Update total games from Firebase using same method as main site
                if (window.dumbassGameAdmin?.isReady && window.firebaseCollection && window.firebaseDb) {
                    try {
                        const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                        const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                        document.getElementById('totalGames').textContent = gamesSnapshot.size;
                    } catch (error) {
                        console.error('Error getting games count:', error);
                        document.getElementById('totalGames').textContent = 'Error';
                    }
                }
                
                // Update users online (basic estimate)
                const usersOnline = window.auth?.currentUser ? 1 : 0;
                document.getElementById('usersOnline').textContent = usersOnline;
                
                // Update top search (placeholder)
                document.getElementById('topSearch').textContent = 'Use main site';
                
            } catch (error) {
                console.warn('Dashboard update error:', error);
            }
        }
        
        // Update stats every 30 seconds
        setInterval(updateDashboardStats, 30000);

        // Twitter Automation Functions
        function runTwitterCommand(command) {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ¦ ${command}()</div>`;
            
            try {
                let result = '';
                
                // Try local Twitter integration first, then fallback to main window
                if (window.TwitterAPI) {
                    switch(command) {
                        case 'systemCheck':
                            result = `ğŸ” System Check:\nâ€¢ Twitter API: ${window.TwitterAPI.isConfigured ? 'âœ… Configured' : 'âŒ Not configured'}\nâ€¢ Admin Dashboard: âœ… Ready`;
                            break;
                        case 'getAutomationStatus':
                            result = `ğŸ“Š Automation Status:\nâ€¢ Twitter Integration: ${window.TwitterAPI.isConfigured ? 'âœ… Ready' : 'âŒ Needs API keys'}\nâ€¢ Auto-posting: ${window.TwitterAPI.isConfigured ? 'ğŸŸ¡ Ready for activation' : 'âŒ Disabled'}`;
                            break;
                        case 'generateDailyTweet':
                            handleGenerateDailyTweet(output);
                            return; // Handle async
                            break;
                        case 'enableTwitter':
                            result = 'âœ… Twitter integration enabled! (Standalone mode)';
                            break;
                        case 'disableTwitter':
                            result = 'âŒ Twitter integration disabled! (Standalone mode)';
                            break;
                        case 'testTwitter':
                            handleTestTwitter(output);
                            return; // Handle async
                        default:
                            result = `Unknown command: ${command}`;
                    }
                } else {
                    // Check if we can access the main site's admin system
                    const mainWindow = window.opener || window.parent;
                    
                    if (mainWindow && mainWindow.dumbassGameAdmin) {
                        // Use main site's admin system
                        switch(command) {
                            case 'systemCheck':
                                result = mainWindow.dumbassGameAdmin.systemCheck();
                                break;
                            case 'getAutomationStatus':
                                result = mainWindow.dumbassGameAdmin.getAutomationStatus();
                                break;
                            case 'generateDailyTweet':
                                result = mainWindow.dumbassGameAdmin.generateDailyTweet();
                                break;
                            case 'enableTwitter':
                                result = mainWindow.dumbassGameAdmin.enableTwitterIntegration();
                                break;
                            case 'disableTwitter':
                                result = mainWindow.dumbassGameAdmin.disableTwitterIntegration();
                                break;
                            case 'testTwitter':
                                result = mainWindow.dumbassGameAdmin.testTwitter ? 
                                        mainWindow.dumbassGameAdmin.testTwitter() : 
                                        'Test function not available';
                                break;
                            default:
                                result = `Unknown command: ${command}`;
                        }
                    } else {
                        // Provide instructions if main site isn't accessible
                        result = `ğŸ”— Twitter integration loading... Please wait or open from main site (localhost:8000)`;
                    }
                }
                
                if (result && result.then) {
                    // Handle promises
                    result.then(res => {
                        output.innerHTML += `<div style="color: #00ff00;">âœ… ${res}</div>`;
                        output.scrollTop = output.scrollHeight;
                        updateTwitterStatus();
                    }).catch(err => {
                        output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${err}</div>`;
                        output.scrollTop = output.scrollHeight;
                    });
                } else {
                    output.innerHTML += `<div style="color: #00ff00;">âœ… ${result}</div>`;
                    updateTwitterStatus();
                }
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        function sendCustomTweet() {
            const input = document.getElementById('customTweetInput');
            const message = input.value.trim();
            
            if (!message) {
                alert('Please enter a tweet message!');
                return;
            }
            
            if (message.length > 280) {
                alert('Tweet is too long! Maximum 280 characters.');
                return;
            }
            
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ¦ Opening Twitter with Custom Tweet</div>`;
            
            try {
                // Create Twitter Web Intent URL
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&hashtags=DumbassGames,RetroGaming`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Twitter opened with message: "${message}"</div>`;
                output.innerHTML += `<div style="color: #00ffff;">ğŸ”— Complete the tweet on Twitter.com</div>`;
                
                // Clear input after success
                input.value = '';
                updateCharCount();
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        function updateCharCount() {
            const input = document.getElementById('customTweetInput');
            const charCount = document.getElementById('charCount');
            const count = input.value.length;
            
            charCount.textContent = count;
            charCount.style.color = count > 280 ? '#ff4444' : count > 250 ? '#ffff00' : '#888';
        }

        // Helper functions for standalone Twitter integration
        async function generateDailyTweetPreview() {
            const now = new Date();
            const dateStr = now.toLocaleDateString();
            
            try {
                // Fetch real data from Firebase
                const output = document.getElementById('consoleOutput');
                output.innerHTML += `<div style="color: #ffff00;">ğŸ“Š Fetching real data from Firebase...</div>`;
                
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Calculate real stats
                const totalGames = games.length;
                const last24Hours = new Date();
                last24Hours.setDate(last24Hours.getDate() - 1);
                
                // Count recent games (last 7 days as proxy for "games played")
                const recentGames = games.filter(game => {
                    const gameDate = game.submittedAt ? new Date(game.submittedAt) : new Date('2024-01-01');
                    return gameDate > last24Hours;
                });
                
                // Find most popular game (by play count or most recent)
                let topGame = 'Retro Adventure';
                if (games.length > 0) {
                    // Sort by play count if available, otherwise by submission date
                    const sortedGames = games.sort((a, b) => {
                        const aPlays = a.playCount || 0;
                        const bPlays = b.playCount || 0;
                        if (aPlays !== bPlays) return bPlays - aPlays;
                        
                        const aDate = new Date(a.submittedAt || '2024-01-01');
                        const bDate = new Date(b.submittedAt || '2024-01-01');
                        return bDate - aDate;
                    });
                    topGame = sortedGames[0]?.title || 'Retro Adventure';
                }
                
                // Generate realistic stats
                const gamesPlayed = Math.max(totalGames * 2, recentGames.length * 10 + Math.floor(Math.random() * 50));
                const newGamers = recentGames.length + Math.floor(Math.random() * 5);
                
                const dailyTweet = `ğŸ“Š 24 HOURS AT DUMBASSGAMES:\nğŸ® ${gamesPlayed} games played\nğŸ‘¥ ${newGamers} new gamers joined\nğŸ† Top game: ${topGame}\nğŸ•¹ï¸ Pure retro fun at dumbassgames.xyz\n#DailyStats #RetroGaming`;
                
                // Store the generated tweet for easy posting
                window.lastGeneratedTweet = dailyTweet;
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Real data loaded: ${totalGames} total games, ${recentGames.length} recent</div>`;
                
                return `ğŸ“Š Daily Tweet Preview for ${dateStr}:\n\n"${dailyTweet}"\n\nğŸ“ˆ Real Stats: ${totalGames} total games in database\nğŸ’¡ Click "Post Daily Tweet" button to send this to Twitter!`;
                
            } catch (error) {
                console.error('Error fetching real data:', error);
                
                // Fallback to placeholder data if Firebase fails
                const dailyTweet = `ğŸ“Š 24 HOURS AT DUMBASSGAMES:\nğŸ® Gaming stats loading...\nğŸ‘¥ Community growing!\nğŸ† Top game: Check dumbassgames.xyz\nğŸ•¹ï¸ Pure retro fun at dumbassgames.xyz\n#DailyStats #RetroGaming`;
                
                window.lastGeneratedTweet = dailyTweet;
                
                return `ğŸ“Š Daily Tweet Preview for ${dateStr}:\n\n"${dailyTweet}"\n\nâš ï¸ Using fallback data (Firebase error: ${error.message})`;
            }
        }

        function handleTestTwitter(output) {
            output.innerHTML += `<div style="color: #ffff00;">ğŸ§ª Opening Twitter for test tweet...</div>`;
            
            try {
                const testMessage = 'ğŸ® Testing DUMBASSGAMES automation! dumbassgames.xyz #RetroGaming #TestTweet';
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(testMessage)}`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Twitter opened with test message!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">ğŸ”— Complete the test tweet on Twitter.com</div>`;
                output.innerHTML += `<div style="color: #888;">ğŸ’¡ This confirms your browser can open Twitter - connection working!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error opening Twitter: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
            updateTwitterStatus();
        }

        async function handleGenerateDailyTweet(output) {
            try {
                const result = await generateDailyTweetPreview();
                output.innerHTML += `<div style="color: #00ff00;">âœ… ${result}</div>`;
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error generating daily tweet: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        async function postDailyTweet() {
            const output = document.getElementById('consoleOutput');
            
            // Check if we have a generated tweet
            if (!window.lastGeneratedTweet) {
                output.innerHTML += `<div style="color: #ffff00; margin-top: 10px;">ğŸ“ Generating fresh daily tweet with real data...</div>`;
                // Generate a new one with real data
                try {
                    await generateDailyTweetPreview();
                } catch (error) {
                    output.innerHTML += `<div style="color: #ff4444;">âŒ Error generating tweet: ${error.message}</div>`;
                    // Fallback tweet
                    window.lastGeneratedTweet = `ğŸ“Š 24 HOURS AT DUMBASSGAMES:\nğŸ® Gaming stats loading...\nğŸ‘¥ Community growing!\nğŸ† Check out dumbassgames.xyz\nğŸ•¹ï¸ Pure retro fun!\n#DailyStats #RetroGaming`;
                }
            }
            
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ“¤ Opening Twitter with Daily Tweet</div>`;
            
            try {
                // Create Twitter Web Intent URL with the daily tweet
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(window.lastGeneratedTweet)}`;
                
                // Open Twitter in new tab
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Twitter opened with daily tweet!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">ğŸ”— Complete the daily tweet on Twitter.com</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            
            output.scrollTop = output.scrollHeight;
        }

        // New Game Alert Tweet
        async function generateNewGameTweet() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ® Generating New Game Alert</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Get most recent game
                const recentGames = games.sort((a, b) => {
                    const aDate = new Date(a.submittedAt || '2024-01-01');
                    const bDate = new Date(b.submittedAt || '2024-01-01');
                    return bDate - aDate;
                });
                
                const newestGame = recentGames[0];
                let tweetText;
                
                if (newestGame) {
                    tweetText = `ğŸ® NEW GAME ALERT! "${newestGame.title}" just joined our retro arcade!\n\n${newestGame.description || 'Pure chaotic gaming goodness!'}\n\nğŸ•¹ï¸ Play now at dumbassgames.xyz\n#NewGame #RetroGaming #IndieGames`;
                } else {
                    tweetText = `ğŸ® NEW GAMES WANTED! Submit your weird, wonderful, and chaotic creations to our retro arcade!\n\nğŸ•¹ï¸ dumbassgames.xyz\n#GameDev #RetroGaming #IndieGames`;
                }
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… New Game Alert opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Game Spotlight Tweet
        async function generateGameSpotlight() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">â­ Generating Game Spotlight</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                if (games.length === 0) {
                    throw new Error('No games found in database');
                }
                
                // Pick a random game to spotlight
                const spotlightGame = games[Math.floor(Math.random() * games.length)];
                
                const adjectives = ['chaotic', 'cursed', 'blessed', 'unhinged', 'galaxy brain', 'peak dumbass', 'vibe coded', 'beautifully broken', 'digitally abominable'];
                const randomAdjective = adjectives[Math.floor(Math.random() * adjectives.length)];
                
                const tweetText = `â­ GAME SPOTLIGHT: "${spotlightGame.title}"\n\n${spotlightGame.description || 'A wild digital abomination!'}\n\nğŸ¯ Why we love it: Pure ${randomAdjective} energy!\nğŸ’€ This is what we call "vibe coded perfection"\n\nğŸ•¹ï¸ Play at dumbassgames.xyz\n#GameSpotlight #VibeGames #DigitalChaos`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Game Spotlight for "${spotlightGame.title}" opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Weekly Summary Tweet
        async function generateWeeklyStats() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ“… Generating Weekly Summary</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                // Calculate weekly stats
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                
                const weeklyGames = games.filter(game => {
                    const gameDate = new Date(game.submittedAt || '2024-01-01');
                    return gameDate > weekAgo;
                });
                
                const totalGames = games.length;
                const weeklySubmissions = weeklyGames.length;
                
                const chaosLevels = {
                    high: 'MAXIMUM OVERDRIVE ğŸŒªï¸',
                    medium: 'beautifully chaotic ğŸ’«', 
                    low: 'ready for more digital abominations ğŸ’€'
                };
                
                const chaosLevel = weeklySubmissions > 3 ? chaosLevels.high : 
                                 weeklySubmissions > 0 ? chaosLevels.medium : chaosLevels.low;
                
                const tweetText = `ğŸ“… WEEKLY CHAOS REPORT:\n\nğŸ® ${totalGames} total digital abominations\nğŸ“ ${weeklySubmissions} new vibe coded games this week\nğŸ”¥ Chaos level: ${chaosLevel}\nğŸ’€ No gatekeeping, just pure vibes\n\nğŸ•¹ï¸ Submit your weird creation at dumbassgames.xyz\n#WeeklyStats #VibeGames #DigitalChaos`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Weekly Summary opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Random Game Recommendation
        async function generateRandomRecommendation() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ² Generating Random Pick</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                if (games.length === 0) {
                    throw new Error('No games found in database');
                }
                
                const randomGame = games[Math.floor(Math.random() * games.length)];
                const vibes = ['cursed but blessed', 'chaotically perfect', 'peak dumbass energy', 'galaxy brain chaos', 'unhinged excellence', 'digitally abominable', 'vibe coded perfection', 'beautifully broken'];
                const randomVibe = vibes[Math.floor(Math.random() * vibes.length)];
                
                const descriptions = [
                    'No description needed - just pure digital chaos!',
                    'The kind of game that shouldn\'t exist, but we\'re glad it does',
                    'Vibe coded perfection in its natural habitat',
                    'This is what happens when chaos meets creativity',
                    'A beautiful disaster waiting to be discovered'
                ];
                
                const randomDescription = descriptions[Math.floor(Math.random() * descriptions.length)];
                
                const tweetText = `ğŸ² CHAOS ROULETTE:\n\n"${randomGame.title}"\n\nğŸ¯ Vibe: ${randomVibe}\nğŸ’­ ${randomGame.description || randomDescription}\n\nğŸ® Feeling chaotic? Play it at dumbassgames.xyz\n#ChaosRoulette #VibeGames #DigitalAbomination`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Random Pick "${randomGame.title}" opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Milestone Tweet
        async function generateMilestone() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ† Generating Milestone Tweet</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                // Determine milestone
                let milestone, message;
                if (totalGames >= 100) {
                    milestone = 'ğŸ’¯ 100+ GAMES';
                    message = 'We\'ve officially hit TRIPLE DIGITS! The arcade is STACKED!';
                } else if (totalGames >= 50) {
                    milestone = 'ğŸ”¥ 50+ GAMES';
                    message = 'Half a century of pure gaming chaos!';
                } else if (totalGames >= 25) {
                    milestone = 'ğŸ¯ 25+ GAMES';
                    message = 'Quarter-century of retro goodness!';
                } else if (totalGames >= 10) {
                    milestone = 'ğŸš€ 10+ GAMES';
                    message = 'Double digits, baby! The collection grows!';
                } else {
                    milestone = 'ğŸŒ± GROWING COLLECTION';
                    message = `${totalGames} games and counting! Submit yours!`;
                }
                
                const tweetText = `ğŸ† MILESTONE ACHIEVED: ${milestone}\n\nğŸ‰ ${message}\n\nğŸ® ${totalGames} games of pure retro insanity\nğŸ‘¥ Powered by an amazing community\n\nğŸ•¹ï¸ Join the chaos at dumbassgames.xyz\n#Milestone #RetroGaming #Community`;
                
                window.lastGeneratedTweet = tweetText;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Milestone tweet (${totalGames} games) opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Vibe Check Tweet
        async function generateVibeCheck() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">âœ¨ Generating Vibe Check Tweet</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const games = gamesSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                
                const vibes = [
                    'cursed but blessed', 'chaotically perfect', 'beautifully broken', 
                    'peak dumbass energy', 'galaxy brain chaos', 'unhinged excellence',
                    'digitally abominable', 'gloriously failing', 'vibe coded perfection',
                    'spectacularly unhinged', 'criminally underrated', 'blessing in disguise',
                    'certified digital chaos', 'premium grade nonsense', 'artistically terrible',
                    'transcendently broken', 'professionally unprofessional', 'academically unserious',
                    'deliberately accidental', 'intentionally confused', 'strategically chaotic',
                    'expertly amateur', 'scientifically unscientific', 'logically illogical',
                    'magnificently cursed', 'divinely dumb', 'wonderfully weird',
                    'fantastically flawed', 'splendidly broken', 'delightfully chaotic'
                ];
                
                const randomVibe = vibes[Math.floor(Math.random() * vibes.length)];
                const totalGames = games.length;
                
                const vibeCheckTweets = [
                    `âœ¨ VIBE CHECK: How's your chaos energy today? ğŸŒªï¸\n\nğŸ® We've got ${totalGames} games of pure ${randomVibe}\nğŸ’€ Digital abominations? âœ…\nğŸ”¥ Glorious failures? âœ…\nâš¡ 60-second submissions? âœ…\n\nğŸ•¹ï¸ Submit your vibe at dumbassgames.xyz\n#VibeCheck #ChaosGaming`,
                    
                    `ğŸ¯ DAILY VIBE: ${randomVibe} ğŸ’«\n\nâœ¨ Current chaos level: MAXIMUM\nğŸ® Games that hit different: ${totalGames}+\nğŸ’€ Your weird game belongs here\nâš¡ No gatekeeping, just pure vibes\n\nğŸš€ dumbassgames.xyz\n#Vibes #DigitalChaos`,
                    
                    `ğŸŒªï¸ CHAOS ENERGY REPORT ğŸ“Š\n\nâœ… Vibe: ${randomVibe}\nâœ… Games: ${totalGames} digital abominations\nâœ… Gatekeeping: Absolutely none\nâœ… Fun guaranteed: 100%\n\nğŸ® What's your vibe? Add it to the collection!\nğŸ‘‰ dumbassgames.xyz\n#VibeCheck`,
                    
                    `ğŸ”¥ VIBE METER READING: ${randomVibe.toUpperCase()} ğŸ“ˆ\n\nğŸ® Collection status: ${totalGames} beautiful disasters\nğŸ’« Quality control: We don't know her\nâš¡ Submission barrier: What barrier?\nâœ¨ Your weird creation needed: YES\n\nğŸš€ dumbassgames.xyz\n#VibeReading #DigitalChaos`,
                    
                    `ğŸ’« TODAY'S ENERGY: ${randomVibe} vibes only ğŸ®\n\nğŸŒŸ Currently hosting ${totalGames} digital monstrosities\nğŸ’€ Cursed content? We love it\nğŸ”¥ Blessed disasters? Even better\nâš¡ Upload time: Still under 60 seconds\n\nâœ¨ dumbassgames.xyz\n#VibeEnergy #ChaosGaming`,
                    
                    `ğŸ® CHAOS BAROMETER: ${randomVibe} detected! ğŸŒªï¸\n\nğŸ“Š Current inventory: ${totalGames} vibe coded masterpieces\nğŸ’€ Sanity level: Not found\nğŸ”¥ Fun level: Off the charts\nâš¡ Barrier to entry: None whatsoever\n\nğŸš€ dumbassgames.xyz\n#ChaosBarometer #VibeGames`
                ];
                
                const randomTweet = vibeCheckTweets[Math.floor(Math.random() * vibeCheckTweets.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Vibe Check tweet opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Chaos Update Tweet
        async function generateChaosUpdate() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸŒªï¸ Generating Chaos Update</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                const chaosUpdates = [
                    `ğŸŒªï¸ CHAOS STATUS UPDATE ğŸ“Š\n\nğŸ’€ Digital abominations catalogued: ${totalGames}\nğŸ”¥ Glorious failures archived: ALL OF THEM\nâš¡ Submission time: Still under 60 seconds\nğŸ¯ Sanity level: Not guaranteed\n\nğŸ® Join the beautiful chaos at dumbassgames.xyz\n#ChaosUpdate`,
                    
                    `ğŸ“¢ BREAKING: Local platform contains ${totalGames} games of pure chaos! ğŸ®\n\nâœ¨ Vibe coded monstrosities? âœ…\nğŸ’€ Cursed but blessed content? âœ…\nğŸŒŸ Zero gatekeeping policy? âœ…\nâš¡ 60-second game uploads? âœ…\n\nğŸš€ dumbassgames.xyz - where chaos thrives\n#DigitalChaos`,
                    
                    `ğŸ® CHAOS LEVEL: MAXIMUM OVERDRIVE ğŸ’«\n\nğŸ”¥ Current collection: ${totalGames} beautiful disasters\nğŸ’€ Quality control: What's that?\nâœ¨ Vibe requirement: Just exist\nâš¡ Upload barrier: Literally none\n\nğŸ‘‰ Add to the chaos: dumbassgames.xyz\n#ChaosGaming`,
                    
                    `âš¡ URGENT UPDATE: Chaos levels reaching critical mass! ğŸš¨\n\nğŸ“Š Abomination count: ${totalGames} and rising\nğŸŒªï¸ Vibe coded disasters: Infinite\nğŸ’€ Approval process: Still doesn't exist\nğŸ”¥ Submission speed: Faster than your regrets\n\nğŸ® dumbassgames.xyz\n#ChaosAlert`,
                    
                    `ğŸ”Š PLATFORM ANNOUNCEMENT: We're officially unhinged! ğŸ’€\n\nğŸ® ${totalGames} games of questionable decisions\nâœ¨ Zero quality gates, maximum chaos gates\nâš¡ Upload your digital crime in 60 seconds\nğŸŒŸ We said yes to everything, and we're not sorry\n\nğŸš€ dumbassgames.xyz\n#UnhingedUpdate`,
                    
                    `ğŸ’« CHAOS METRICS REPORT: Everything is on fire! ğŸ”¥\n\nğŸ“ˆ Collection growth: ${totalGames} beautiful mistakes\nğŸ¯ Rejection rate: 0% (we're not monsters)\nğŸ’€ Average submission quality: Perfectly imperfect\nâš¡ Time to regret your upload: Immediate\n\nğŸ® dumbassgames.xyz\n#ChaosMetrics`,
                    
                    `ğŸŒªï¸ SYSTEM STATUS: Beautifully broken as intended ğŸ’\n\nğŸ® Games that shouldn't exist: ${totalGames}\nâœ¨ Games we're glad exist anyway: Also ${totalGames}\nğŸ’€ Cursed content warnings: We gave up\nğŸ”¥ Blessed disaster counter: Off the charts\n\nğŸš€ dumbassgames.xyz\n#SystemChaos`
                ];
                
                const randomTweet = chaosUpdates[Math.floor(Math.random() * chaosUpdates.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Chaos Update opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Developer Callout Tweet
        async function generateDevCallout() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ“¢ Generating Dev Callout</div>`;
            
            const devCallouts = [
                `ğŸ“¢ CALLING ALL DEVS! ğŸ®\n\nğŸ¤” Got a game that's "finished" but cursed?\nğŸ’¡ Built something weird in a game jam?\nğŸ”¥ Created digital chaos that somehow works?\nâš¡ Have a URL? That's literally our only requirement!\n\nâœ¨ dumbassgames.xyz - 60 second submissions\n#GameDev #IndieGames`,
                
                `ğŸ¯ ATTENTION GAME CREATORS! ğŸ’«\n\nâœ… Your game doesn't need to be "good"\nâœ… Weird, broken, or bizarre? PERFECT\nâœ… Made in 5 minutes? Upload it anyway\nâœ… Got a working URL? You're already qualified\n\nğŸš€ No gatekeeping at dumbassgames.xyz\n#GameDev #VibeGames`,
                
                `ğŸ’€ DIGITAL ABOMINATION COLLECTORS WANTED! ğŸ®\n\nğŸ”¥ Made something that shouldn't exist? WE WANT IT\nâš¡ Browser games, web experiments, chaos engines\nğŸ¯ Working URL = automatic acceptance\nğŸ’« Submission time: Under 60 seconds, guaranteed\n\nğŸ‘‰ dumbassgames.xyz\n#GameDev #WebGames`,
                
                `ğŸŒŸ GAME DEVS: Your "trash" is our treasure! ğŸ’\n\nâœ¨ Prototype that got out of hand? Perfect\nğŸ® Game jam disaster? Even better\nğŸ’€ Something that barely works? IDEAL\nâš¡ URL ready? Submit in 60 seconds\n\nğŸš€ Zero judgment zone: dumbassgames.xyz\n#IndieGames #GameDev`,
                
                `ğŸš¨ DEV EMERGENCY: We need your weird games! ğŸ®\n\nğŸ’­ That thing you made at 3am? UPLOAD IT\nğŸ”¥ Broken physics engine? WE'LL TAKE IT\nâš¡ Accidentally good bad game? PERFECT\nğŸ’€ Cursed HTML5 experiment? YES PLEASE\n\nğŸš€ dumbassgames.xyz\n#DevEmergency #CursedGames`,
                
                `ğŸª WANTED: Creators of digital circus acts! ğŸ’«\n\nğŸ¤¹ Juggling game logic and prayer? That's our vibe\nğŸ¨ Art style: "I tried my best"? IDEAL\nğŸµ Sound design: Random keyboard mashing? CHEF'S KISS\nâš¡ Submission requirement: One (1) working URL\n\nğŸŒŸ dumbassgames.xyz\n#DigitalCircus #GameDev`,
                
                `ğŸ”Š PSA FOR DEVS: Your rejected game jam entry belongs here! ğŸ®\n\nğŸ’” Too weird for itch.io? Perfect for us\nğŸŒªï¸ Judges didn't "get it"? We will\nğŸ’€ Broke the theme spectacularly? AMAZING\nâš¡ Upload faster than your regret sets in\n\nâœ¨ dumbassgames.xyz\n#GameJamRejects #VibeGames`,
                
                `ğŸ“¡ SIGNAL BOOST: Seeking creators of beautiful disasters! ğŸ’\n\nğŸ® Tutorial you never finished? Upload the chaos\nğŸ”¥ Feature that became the whole game? ICONIC\nğŸ’« Bug that's now a core mechanic? GENIUS\nâš¡ Working in browser? You're 100% qualified\n\nğŸš€ dumbassgames.xyz\n#BeautifulDisasters #WebGames`
            ];
            
            const randomTweet = devCallouts[Math.floor(Math.random() * devCallouts.length)];
            window.lastGeneratedTweet = randomTweet;
            
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
            window.open(twitterUrl, '_blank');
            
            output.innerHTML += `<div style="color: #00ff00;">âœ… Dev Callout opened in Twitter!</div>`;
            output.scrollTop = output.scrollHeight;
        }

        // Fun Fact Tweet
        async function generateFunFact() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ¯ Generating Fun Fact</div>`;
            
            try {
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                const funFacts = [
                    `ğŸ¯ FUN FACT: DUMBASSGAMES has ${totalGames} games and exactly ZERO gatekeepers! ğŸ®\n\nâœ¨ Every game gets in if it has a URL\nğŸ’€ Quality control is just a suggestion\nâš¡ Submission time: Always under 60 seconds\nğŸ”¥ Chaos level: Guaranteed maximum\n\nğŸ‘‰ dumbassgames.xyz\n#FunFact`,
                    
                    `ğŸ’¡ DID YOU KNOW? We've archived ${totalGames} digital abominations! ğŸ’€\n\nğŸ® From cursed to blessed\nâœ¨ From broken to beautiful\nğŸŒªï¸ From chaos to... more chaos\nâš¡ All submitted in under 60 seconds\n\nğŸš€ Add yours: dumbassgames.xyz\n#DidYouKnow #DigitalChaos`,
                    
                    `ğŸŒŸ WILD FACT: Our platform requires literally ONE thing - a working URL! ğŸ¯\n\nâŒ No approval process\nâŒ No quality standards\nâŒ No gatekeeping\nâœ… Just pure vibe coded chaos\n\nğŸ® ${totalGames} games and counting at dumbassgames.xyz\n#WildFact #VibeGames`,
                    
                    `ğŸ”¥ RANDOM FACT: Every game on DUMBASSGAMES was submitted by someone who said "this is probably dumb, but..." ğŸ®\n\nğŸ’« Plot twist: We LOVE dumb\nâœ¨ Dumb is our specialty\nğŸ’€ Dumb games = best games\n\nğŸ‘‰ Submit your dumb game: dumbassgames.xyz\n#RandomFact #DumbGames`,
                    
                    `ğŸ§  BRAIN FACT: Our rejection rate is 0% and we're proud of it! ğŸ’€\n\nğŸ® ${totalGames} games submitted, ${totalGames} games accepted\nâœ¨ Mathematical perfection: 100% chaos rate\nâš¡ Upload regret timeline: Instant\nğŸ”¥ Fun guarantee: Unbreakable\n\nğŸš€ dumbassgames.xyz\n#BrainFact #ZeroRejection`,
                    
                    `ğŸ’€ SPOOKY FACT: We've never rejected a single game! ğŸ‘»\n\nğŸ® Horror rate: 0% (we love everything)\nâœ¨ Acceptance rate: Suspiciously high (100%)\nâš¡ Quality standards: What are those?\nğŸŒŸ Your game's survival rate: Guaranteed\n\nğŸ”¥ dumbassgames.xyz\n#SpookyFact #DigitalHorror`,
                    
                    `ğŸ¤¯ MIND-BLOWING FACT: Our longest submission took 37 seconds! âš¡\n\nğŸ® Average upload time: Under 30 seconds\nğŸ’€ Fastest submission: 8 seconds (new record!)\nâœ¨ Slowest submission: Still faster than ordering pizza\nğŸ”¥ Current collection: ${totalGames} speed-submitted disasters\n\nğŸš€ dumbassgames.xyz\n#SpeedFact #FastChaos`,
                    
                    `ğŸ­ THEATER FACT: Every game here is a performance art piece! ğŸª\n\nğŸ® Intentional games: Some of them\nğŸ’€ Accidental masterpieces: Most of them\nâœ¨ Games that transcend understanding: ${totalGames}\nâš¡ Art critics' opinion: We don't ask\n\nğŸŒŸ dumbassgames.xyz\n#ArtFact #DigitalTheater`,
                    
                    `ğŸ§ª SCIENCE FACT: We're conducting the world's largest chaos experiment! ğŸ”¬\n\nğŸ® Test subjects: ${totalGames} digital specimens\nğŸ’€ Control group: Doesn't exist\nâœ¨ Hypothesis: Chaos = Fun\nâš¡ Results: Hypothesis confirmed\n\nğŸ”¥ dumbassgames.xyz\n#ScienceFact #ChaosExperiment`
                ];
                
                const randomTweet = funFacts[Math.floor(Math.random() * funFacts.length)];
                window.lastGeneratedTweet = randomTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Fun Fact tweet opened in Twitter!</div>`;
                
            } catch (error) {
                output.innerHTML += `<div style="color: #ff4444;">âŒ Error: ${error.message}</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        // Site Promotional Tweet
        async function generateSitePromo() {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸš€ Generating Site Promotional Tweet</div>`;
            
            try {
                // Get current game count for dynamic messaging
                const gamesCollection = window.firebaseCollection(window.firebaseDb, 'games');
                const gamesSnapshot = await window.firebaseGetDocs(gamesCollection);
                const totalGames = gamesSnapshot.size;
                
                // Array of different promotional tweets to rotate through
                const promoTweets = [
                    // Main pitch tweet
                    `ğŸ® DUMBASSGAMES: Where Digital Abominations Meet Glorious Failures! ğŸ’€\n\nâœ¨ Discover vibe coded monstrosities\nğŸ•¹ï¸ Play ${totalGames}+ chaotic retro games\nâš¡ Submit YOUR game in under 60 seconds\nğŸ¯ No gatekeeping, just pure gaming chaos\n\nğŸ”— dumbassgames.xyz\n#RetroGaming #IndieGames #VibeGames`,
                    
                    // Developer focused
                    `ğŸ“¢ CALLING ALL GAME DEVS! ğŸ¯\n\nğŸ® Got a weird, broken, or brilliant game?\nâ±ï¸ Submit it to DUMBASSGAMES in <60 seconds\nğŸ”¥ No approval process, no waiting\nğŸ‘¥ Instant community of chaos lovers\nğŸ’ From cursed to blessed - we want it all!\n\nğŸš€ dumbassgames.xyz\n#GameDev #IndieGames`,
                    
                    // Community focused  
                    `ğŸ† ${totalGames}+ VIBE CODED GAMES & COUNTING! ğŸ®\n\nğŸ’€ Digital abominations? âœ…\nğŸŒŸ Glorious failures? âœ…  \nğŸ¯ Peak dumbass content? âœ…\nâš¡ 60-second game submissions? âœ…\nğŸ”¥ Sanity not guaranteed? âœ…\n\nğŸ•¹ï¸ Join the chaos at dumbassgames.xyz\n#RetroGaming #ChaosGaming`,
                    
                    // Nostalgia focused
                    `ğŸ•¹ï¸ REMEMBER WHEN GAMES WERE JUST... WEIRD? ğŸ®\n\nğŸ’« DUMBASSGAMES brings back that energy:\nğŸ¯ No corporate polish, just raw creativity\nâš¡ Submit your game in 60 seconds flat\nğŸ”¥ ${totalGames}+ games of pure retro insanity\nğŸ’€ Sanity not guaranteed, fun definitely is!\n\nğŸš€ dumbassgames.xyz\n#RetroGaming #IndieGames`,
                    
                    // Simple and direct
                    `ğŸ® FREE RETRO GAME ARCADE âš¡\n\nğŸ”¥ ${totalGames}+ vibe coded games\nâ±ï¸ Add YOUR game in <1 minute\nğŸ’€ Digital abominations welcome\nğŸ¯ No gatekeeping, pure chaos\nğŸ•¹ï¸ Browser-based, instant play\n\nğŸ‘‰ dumbassgames.xyz\n#FreeGames #RetroGaming #BrowserGames`,
                    
                    // Chaos-focused
                    `ğŸŒªï¸ THE INTERNET'S MOST UNHINGED GAME COLLECTION! ğŸ’€\n\nğŸ® ${totalGames}+ games that probably shouldn't exist\nğŸ’« But we're glad they do anyway\nâš¡ Fastest submission process on the web\nğŸ”¥ Zero quality control, maximum fun\n\nâœ¨ dumbassgames.xyz\n#ChaosGaming #DigitalChaos`,
                    
                    // Anti-corporate
                    `ğŸ¯ TIRED OF CORPORATE GAMES? Try digital chaos instead! ğŸ®\n\nğŸ’€ No polish, just passion\nğŸ”¥ No committees, just creativity\nâš¡ No barriers, just browsers\nğŸŒŸ No gatekeeping, just games\n\nğŸ‘‰ ${totalGames}+ indie abominations at dumbassgames.xyz\n#IndieGames #AntiCorporate`,
                    
                    // Creator-focused
                    `ğŸš€ CREATORS: Your weird game has a home! ğŸ®\n\nâœ¨ Made something in 5 minutes? PERFECT\nğŸ’€ Accidentally created art? EVEN BETTER\nâš¡ Got a browser game? YOU'RE IN\nğŸ”¥ Have zero budget? WHO CARES\n\nğŸŒŸ dumbassgames.xyz - where creativity wins\n#CreateToday #IndieCreators`,
                    
                    // Discovery-focused
                    `ğŸ•¹ï¸ DISCOVER GAMES YOU'VE NEVER SEEN BEFORE! ğŸ®\n\nğŸ’« No algorithm, just pure chaos\nğŸ¯ ${totalGames}+ hidden gems & disasters\nâš¡ New submissions daily\nğŸ’€ From blessed to cursed, we have it all\n\nğŸ”¥ Start exploring: dumbassgames.xyz\n#GameDiscovery #HiddenGems`
                ];
                
                // Pick a random promotional tweet
                const randomTweet = promoTweets[Math.floor(Math.random() * promoTweets.length)];
                
                window.lastGeneratedTweet = randomTweet;
                
                // Open Twitter
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(randomTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #00ff00;">âœ… Site Promotional Tweet opened in Twitter!</div>`;
                output.innerHTML += `<div style="color: #00ffff;">ğŸ¯ Perfect for attracting new players and developers!</div>`;
                
            } catch (error) {
                // Fallback promotional tweet if Firebase fails
                const fallbackTweet = `ğŸ® DUMBASSGAMES: The retro arcade for vibe coded monstrosities! ğŸ’€\n\nâš¡ Submit your game in 60 seconds\nğŸ”¥ No gatekeeping, just pure chaos\nğŸ•¹ï¸ Digital abominations & glorious failures welcome\n\nğŸš€ dumbassgames.xyz\n#RetroGaming #IndieGames #VibeGames`;
                
                window.lastGeneratedTweet = fallbackTweet;
                
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(fallbackTweet)}`;
                window.open(twitterUrl, '_blank');
                
                output.innerHTML += `<div style="color: #ffff00;">âš ï¸ Using fallback promo tweet (Firebase error)</div>`;
                output.innerHTML += `<div style="color: #00ff00;">âœ… Promotional Tweet opened in Twitter!</div>`;
            }
            output.scrollTop = output.scrollHeight;
        }

        function updateTwitterStatus() {
            try {
                // Check local Twitter integration first
                if (window.TwitterAPI) {
                    // Update Twitter Status
                    const twitterStatus = document.getElementById('twitterStatus');
                    twitterStatus.textContent = 'âœ… CONNECTED';
                    twitterStatus.style.color = '#00ff00';
                    
                    // Update API Keys Status
                    const twitterKeys = document.getElementById('twitterKeys');
                    if (window.TwitterAPI.isConfigured) {
                        twitterKeys.textContent = 'âœ… CONFIGURED';
                        twitterKeys.style.color = '#00ff00';
                    } else {
                        twitterKeys.textContent = 'âŒ MISSING';
                        twitterKeys.style.color = '#ff4444';
                    }
                    
                    // Update Automation Status
                    const automationStatus = document.getElementById('automationStatus');
                    if (window.TwitterAPI.isConfigured) {
                        automationStatus.textContent = 'âœ… ENABLED';
                        automationStatus.style.color = '#00ff00';
                    } else {
                        automationStatus.textContent = 'âŒ DISABLED';
                        automationStatus.style.color = '#ff4444';
                    }
                    
                    // Update Last Tweet
                    const lastTweet = document.getElementById('lastTweet');
                    lastTweet.textContent = window.TwitterAPI.isConfigured ? 'Ready to Tweet' : 'Configure API Keys';
                    lastTweet.style.color = window.TwitterAPI.isConfigured ? '#00ff00' : '#ffff00';
                    
                } else {
                    // Fallback to main window check
                    const mainWindow = window.opener || window.parent;
                    
                    if (mainWindow && mainWindow.dumbassGameAdmin && mainWindow.siteMonitoring) {
                        // Update Twitter Status
                        const twitterStatus = document.getElementById('twitterStatus');
                        if (mainWindow.siteMonitoring) {
                            twitterStatus.textContent = 'âœ… CONNECTED';
                            twitterStatus.style.color = '#00ff00';
                        } else {
                            twitterStatus.textContent = 'âŒ DISCONNECTED';
                            twitterStatus.style.color = '#ff4444';
                        }
                        
                        // Update API Keys Status
                        const twitterKeys = document.getElementById('twitterKeys');
                        if (mainWindow.TwitterAPI && mainWindow.TwitterAPI.isConfigured) {
                            twitterKeys.textContent = 'âœ… CONFIGURED';
                            twitterKeys.style.color = '#00ff00';
                        } else {
                            twitterKeys.textContent = 'âŒ MISSING';
                            twitterKeys.style.color = '#ff4444';
                        }
                        
                        // Update Automation Status
                        const automationStatus = document.getElementById('automationStatus');
                        const status = mainWindow.siteMonitoring.getAutomationStatus();
                        if (status && status.twitter) {
                            automationStatus.textContent = 'âœ… ENABLED';
                            automationStatus.style.color = '#00ff00';
                        } else {
                            automationStatus.textContent = 'âŒ DISABLED';
                            automationStatus.style.color = '#ff4444';
                        }
                        
                        // Update Last Tweet
                        const lastTweet = document.getElementById('lastTweet');
                        lastTweet.textContent = 'Simulation Mode';
                        lastTweet.style.color = '#ffff00';
                        
                    } else {
                        // Not connected to main site and no local Twitter
                        ['twitterStatus', 'twitterKeys', 'automationStatus'].forEach(id => {
                            const element = document.getElementById(id);
                            element.textContent = 'â³ LOADING...';
                            element.style.color = '#ffff00';
                        });
                        
                        const lastTweet = document.getElementById('lastTweet');
                        lastTweet.textContent = 'Loading...';
                        lastTweet.style.color = '#888';
                    }
                }
            } catch (error) {
                console.warn('Error updating Twitter status:', error);
            }
        }

        // Set up character counter for tweet input
        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('customTweetInput');
            if (input) {
                input.addEventListener('input', updateCharCount);
                
                // Allow Enter key to send tweet
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendCustomTweet();
                    }
                });
            }
            
            // Initial Twitter status update
            setTimeout(updateTwitterStatus, 2000);
            
            // Update Twitter status every 10 seconds
            setInterval(updateTwitterStatus, 10000);
        });
        
        // Initial update after page loads
        setTimeout(updateDashboardStats, 2000);
        
        // Welcome message
        setTimeout(() => {
            consoleDiv.innerHTML += `<div style="color: #00ffff; margin-top: 10px;">ğŸ® DUMBASSGAMES Admin Dashboard Ready!</div>`;
            consoleDiv.innerHTML += `<div style="color: #888;">Loading admin systems...</div>`;
            
            // Check if admin system is ready
            const checkAdminReady = () => {
                if (window.dumbassGameAdmin) {
                    consoleDiv.innerHTML += `<div style="color: #00ff00;">âœ… Admin system loaded! Commands are now available.</div>`;
                    updateDashboardStats();
                } else {
                    consoleDiv.innerHTML += `<div style="color: #ffff00;">â³ Still loading... Please wait...</div>`;
                    setTimeout(checkAdminReady, 2000);
                }
            };
            
            setTimeout(checkAdminReady, 3000);
        }, 1000);
    </script>
    
    <!-- Twitter Integration Script -->
    <script src="twitter-integration.js"></script>
</body>
</html> 